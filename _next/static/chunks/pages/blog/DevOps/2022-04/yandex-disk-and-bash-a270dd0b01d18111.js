(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6198],{40990:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/DevOps/2022-04/yandex-disk-and-bash",function(){return t(98369)}])},98369:function(e,n,t){"use strict";t.r(n);var r=t(85893),l=t(97037);t(67294);var i=t(13803),a=t(46416);n.default=()=>(0,r.jsxs)(l.Xg,{blogcentered:!0,children:[(0,r.jsx)(l.xv,{title:!0,className:"mt-10 md:text",children:"Подготовка токена для работы с API"}),(0,r.jsxs)(l.xv,{p:!0,children:["Вся информация по работе с API есть в ",(0,r.jsx)("b",{children:(0,r.jsx)("u",{children:(0,r.jsx)(l.e9,{newTab:!0,href:"https://yandex.ru/dev/disk/rest/",children:"официальной документации"})})}),", если нужны подробности."]}),(0,r.jsx)(l.xv,{p:!0,children:"Тут все просто."}),(0,r.jsxs)(l.aV,{type:a.RH.number,children:[(0,r.jsx)("li",{children:"Идем по ссылке и входим под нужной учетной записью Яндекса, после чего нажимаем “Зарегистрировать новое приложение”."}),(0,r.jsxs)("li",{children:["Настраиваем новое приложение:",(0,r.jsxs)(l.aV,{children:[(0,r.jsx)("li",{children:"Заполняем название приложения и его описание."}),(0,r.jsx)("li",{children:"Даем права для работы с API, а именно в разделе “Яндекс.Диск REST API” отмечаем “Доступ к информации о Диске” и “Доступ к папке приложения на Диске”."}),(0,r.jsx)("li",{children:"В разделе “Платформы” устанавливаем флаг “Веб-сервисы”, после чего заполняем параметр “Callback URL”, нажав на “Подставить URL для разработки”."}),(0,r.jsx)("li",{children:"Другие параметры приложения используйте по необходимости."})]})]}),(0,r.jsx)("li",{children:"После сохранения будет выполнено перенаправление на страницу с данными нового приложения. Сохраняем эту информацию себе."}),(0,r.jsxs)("li",{children:["Переходим по ссылке и разрешаем доступ приложения.",(0,r.jsx)(i.Z,{code:"\nhttps://oauth.yandex.ru/authorize?response_type=token&client_id=<ЗдесьIdПриложенияИзПрошлогоПункта>\n                        ",className:"my-5",language:"text"})]}),(0,r.jsx)("li",{children:"После подтверждения получим токен для работы с API, который будет действовать 1 год."}),(0,r.jsx)("li",{children:"Профит!"})]}),(0,r.jsx)(l.xv,{title:!0,className:"mt-10 md:text",children:"Отправляем файл"}),(0,r.jsx)(l.xv,{p:!0,children:"Вот простой скрипт для отправки файла на Яндекс.Диск. По необходимости в скрипт можно добавить проверки ошибок, логирование и так далее. Здесь лишь простейший пример."}),(0,r.jsx)(i.Z,{code:'\n#!/bin/bash\n\nFILENAME="somefile.txt"\nFILEPATH="/home/<username>/$FILENAME"\nTOKEN=\'<ТокенЯндексДискAPI>\'\n\n# Простая функция для парсинга свойств из JSON\nfunction parseJson()\n{\n    local output\n    regex="(\\"$1\\":[\\"]?)([^\\",\\}]+)([\\"]?)"\n    [[ $2 =~ $regex ]] && output=${BASH_REMATCH[2]}\n    echo $output\n}\n\n# Функция для отправки файла\nfunction sendFile\n{\n    echo "Start sending a file: $1"\n\n    # Получаем URL для загрузки файла\n    sendUrlResponse=`curl -s -H "Authorization: OAuth $TOKEN" https://cloud-api.yandex.net:443/v1/disk/resources/upload/?path=app:/$FILENAME&overwrite=true`\n    sendUrl=$(parseJson \'href\' $sendUrlResponse)\n\n    # Отправляем файл\n    sendFileResponse=`curl -s -T $FILEPATH -H "Authorization: OAuth $TOKEN" $sendUrl`\n\n    echo "Completing a file upload: $1"\n}\n\nsendFile $FILEPATH\n                ',className:"my-5",language:"bash"}),(0,r.jsx)(l.xv,{p:!0,children:"Найти эти файлы в веб-интерфейсе можно перейдя на Яндекс.Диск в браузере, далее зайти в папку “Приложения”. В ней вы увидите подкаталог с именем приложения, там все файлы и будут расположены."}),(0,r.jsx)(l.xv,{title:!0,className:"mt-10 md:text",children:"Полезные ссылки"}),(0,r.jsxs)(l.aV,{children:[(0,r.jsx)("li",{children:(0,r.jsx)("b",{children:(0,r.jsx)("u",{children:(0,r.jsx)(l.e9,{newTab:!0,href:"https://yandex.ru/dev/disk/rest/",children:"Официальная документация"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("b",{children:(0,r.jsx)("u",{children:(0,r.jsx)(l.e9,{newTab:!0,href:"https://neblog.info/skript-bekapa-na-yandeks-disk",children:"Скрипт бекапа на Яндекс.Диск"})})})}),(0,r.jsx)("li",{children:(0,r.jsx)("b",{children:(0,r.jsx)("u",{children:(0,r.jsx)(l.e9,{newTab:!0,href:"placecity.ru/idea/skripty/bekap-na-yandeks-disk",children:"Скрипт бекапа сайта и баз данных на яндекс диск с отправкой смс и удалением старых архивов"})})})})]})]})},12250:function(e,n,t){"use strict";var r,l;t.d(n,{b:function(){return r}}),(l=r||(r={})).Min="350px",l.Standard="700px",l.Large="1000x",l.Unlimited=""},13803:function(e,n,t){"use strict";var r=t(37340),l=t(85893),i=t(67294),a=t(14965),s=t(54951),d=t(41686),c=t(12250);function o(){let e=(0,r._)(["\n        text-align: left;\n        overflow: hidden;\n        font-size: 14px;\n        border-radius: 6px;\n        overflow: auto;\n\n        & .token-line {\n            line-height: 1.3em;\n            height: 1.3em;\n        }\n    "]);return o=function(){return e},e}function h(){let e=(0,r._)(["\n        max-height: ","\n    "]);return h=function(){return e},e}n.Z=e=>{let{code:n,className:r,language:u,maxHeight:x=c.b.Standard}=e;(void 0!==t.g?t.g:window).Prism=a.p1,t(61354),t(79016),t(2731),t(35266),t(92927),t(51315),t(57874),t(86862);let p=null!=x?x:c.b.Standard,b=d.ZP.pre(o()),m=(0,d.ZP)(b)(h(),p);return(0,l.jsx)("div",{className:(0,s.GF)("bg-blue-500 md:p-1 p-2",r),children:(0,l.jsx)("div",{className:"shadow-lg",children:(0,l.jsx)(a.y$,{theme:a.np.vsDark,code:n.trim(),language:null!=u?u:u="tsx",children:e=>{let{className:n,style:t,tokens:r,getLineProps:a,getTokenProps:s}=e;return(0,l.jsx)(m,{className:n,style:t,children:r.map((e,n)=>(0,i.createElement)("div",{...a({line:e,key:n}),key:Math.random()},e.map((e,n)=>(0,i.createElement)("span",{...s({token:e,key:n}),key:Math.random()}))))})}})})})}},97037:function(e,n,t){"use strict";t.d(n,{Ee:function(){return s},Xg:function(){return i},Y7:function(){return h},aV:function(){return c},e9:function(){return o},o_:function(){return u},tf:function(){return x},ty:function(){return d},xv:function(){return a}});var r=t(5152),l=t.n(r);let i=l()(()=>Promise.all([t.e(549),t.e(4738),t.e(4838),t.e(1664),t.e(1274)]).then(t.bind(t,91274)),{loadableGenerated:{webpack:()=>[91274]}}),a=l()(()=>Promise.all([t.e(4454),t.e(7897)]).then(t.bind(t,97897)),{loadableGenerated:{webpack:()=>[97897]}}),s=l()(()=>Promise.all([t.e(3536),t.e(2726)]).then(t.bind(t,2726)),{loadableGenerated:{webpack:()=>[2726]}}),d=l()(()=>Promise.all([t.e(549),t.e(378)]).then(t.bind(t,90378)),{loadableGenerated:{webpack:()=>[90378]}}),c=l()(()=>Promise.all([t.e(9300),t.e(7200)]).then(t.bind(t,7200)),{loadableGenerated:{webpack:()=>[7200]}}),o=l()(()=>Promise.all([t.e(1664),t.e(8681)]).then(t.bind(t,28681)),{loadableGenerated:{webpack:()=>[28681]}});l()(()=>t.e(2857).then(t.bind(t,22857)),{loadableGenerated:{webpack:()=>[22857]}});let h=l()(()=>Promise.all([t.e(2004),t.e(3070)]).then(t.bind(t,63070)),{loadableGenerated:{webpack:()=>[63070]}}),u=l()(()=>Promise.all([t.e(162),t.e(3959),t.e(6050),t.e(239),t.e(727)]).then(t.bind(t,32215)),{loadableGenerated:{webpack:()=>[32215]}}),x=l()(()=>Promise.all([t.e(162),t.e(1664),t.e(3959),t.e(6050),t.e(4205)]).then(t.bind(t,84205)),{loadableGenerated:{webpack:()=>[84205]}})}},function(e){e.O(0,[4104,2888,9774,179],function(){return e(e.s=40990)}),_N_E=e.O()}]);