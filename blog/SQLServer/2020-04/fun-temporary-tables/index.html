<!DOCTYPE html><html lang="en" translate="no"><head><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="google" content="notranslate"/><title>Эти занимательные временные таблицы | Убежище инженера | YPermitin</title><meta name="robots" content="index,follow"/><meta name="description" content="Кое-что интересное о временных таблицах и работе платформы 1С с ними."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://ypermitin.github.io/blog/SQLServer/2020-04/fun-temporary-tables"/><meta property="og:title" content="Эти занимательные временные таблицы | Убежище инженера | YPermitin"/><meta property="og:description" content="Кое-что интересное о временных таблицах и работе платформы 1С с ними."/><meta property="og:url" content="https://ypermitin.github.io/blog/SQLServer/2020-04/fun-temporary-tables"/><meta property="og:type" content="website"/><meta property="og:image" content="https://ypermitin.github.io/imp_assets/SQLServer/2020-04/fun-temporary-tables/logo.png"/><meta property="og:image:alt" content="Эти занимательные временные таблицы | Убежище инженера | YPermitin"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:locale" content="en_IN"/><meta property="og:site_name" content="Убежище инженера"/><link rel="canonical" href="https://webexpe.com/"/><meta property="keywords" content="SQL Server, 1С:Предприятие, TempDB, временные таблицы, оптимизация, производительность"/><meta property="al:web:url" content="https://ypermitin.github.io/blog/SQLServer/2020-04/fun-temporary-tables"/><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/3572aef5c92b999a.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/3572aef5c92b999a.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/74d45923820614f0.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/74d45923820614f0.css" crossorigin=""/><link rel="preload" href="/_next/static/css/4a9df9e795bce52b.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/4a9df9e795bce52b.css" crossorigin=""/><link rel="preload" href="/_next/static/css/ee5420a43edabb61.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/ee5420a43edabb61.css" crossorigin=""/><link rel="preload" href="/_next/static/css/88381d5dde4793c2.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/88381d5dde4793c2.css" crossorigin=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/_next/static/chunks/fea29d9f.ed258e6733dee3dc.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/3a17f596.ba96fa4a4d0542ad.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1664-4a06aa529298108a.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/7167.f2f73d92f46b437d.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1465.2204281cc9cfb98d.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/9179.149e20aab74a9c64.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/6806.0e24ace3ea941b14.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1974.532a76ac54dd3d02.js" crossorigin=""></script><script src="/_next/static/chunks/webpack-a03c5492e9bbae29.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-92a422f151f77ddb.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-603010d06ef22166.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-09d943187c0df7b5.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/1102-e16f2e3f75ecbbbc.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/3811-a1e411622d637720.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/433-c58f51caaedde378.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/SQLServer/2020-04/fun-temporary-tables-0aac239f01991aef.js" defer="" crossorigin=""></script><script src="/_next/static/w6SFBBOZSxxQOc3fUMUQB/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/w6SFBBOZSxxQOc3fUMUQB/_ssgManifest.js" defer="" crossorigin=""></script></head><body class="bg-slate-100 dark:bg-slate-900 transition-all"><div id="__next"><div data-overlay-container="true"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav class="Navbar_navbar__W_ouQ bg-white  dark:bg-slate-900 dark:text-white text-black"><div class="container flex items-center justify-between px-2"><div class="flex items-center"><div class="Navbar_mobileBurgerToggle__Bj_52 mr-5  "><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="dark:text-white text-black text-2xl" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></div><a class="text-[22px] font-semibold" href="/">Убежище инженера</a></div><div class="flex items-center"><div class="text-[14px] font-normal items-center lg:flex hidden"><a class="cursor-pointer hover:text-blue-500 mx-2" href="/">Главная</a><div class="relative"><div class="flex items-center cursor-pointer mx-2"><p class="my-0">Блог</p><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-[20px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16.293 9.293 12 13.586 7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z"></path></svg></div><div class="overflow-auto absolute w-[180px] z-20 top-[30px] rounded-[4px] shadow-lg bg-white dark:bg-slate-800 border border-gray-300 dark:border-0 h-0 border-0"><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2" href="/blog/"><span>Все публикации</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=.NET"><span style="text-transform:capitalize">.NET</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=PostgreSQL"><span style="text-transform:capitalize">PostgreSQL</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=DevOps"><span style="text-transform:capitalize">DevOps</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=SQL%20Server"><span style="text-transform:capitalize">SQL Server</span></a></div></div><a class="cursor-pointer hover:text-blue-500 mx-2" href="/instruments/">Инструменты</a><a class="cursor-pointer hover:text-blue-500 mx-2" href="/about/">Обо мне</a><a class="cursor-pointer hover:text-blue-500 mx-2" href="/contact/">Контакты</a><div class="ml-5 pt-1"><a href="https://github.com/YPermitin/" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><a href="https://t.me/TinyDevVault" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg></a><a href="mailto:i.need.ypermitin@yandex.ru" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a><a href="https://boosty.to/ypermitin" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 21h9.62a3.995 3.995 0 0 0 3.037-1.397l5.102-5.952a1 1 0 0 0-.442-1.6l-1.968-.656a3.043 3.043 0 0 0-2.823.503l-3.185 2.547-.617-1.235A3.98 3.98 0 0 0 9.146 11H4c-1.103 0-2 .897-2 2v6c0 1.103.897 2 2 2zm0-8h5.146c.763 0 1.448.423 1.789 1.105l.447.895H7v2h6.014a.996.996 0 0 0 .442-.11l.003-.001.004-.002h.003l.002-.001h.004l.001-.001c.009.003.003-.001.003-.001.01 0 .002-.001.002-.001h.001l.002-.001.003-.001.002-.001.002-.001.003-.001.002-.001c.003 0 .001-.001.002-.001l.003-.002.002-.001.002-.001.003-.001.002-.001h.001l.002-.001h.001l.002-.001.002-.001c.009-.001.003-.001.003-.001l.002-.001a.915.915 0 0 0 .11-.078l4.146-3.317c.262-.208.623-.273.94-.167l.557.186-4.133 4.823a2.029 2.029 0 0 1-1.52.688H4v-6zM16 2h-.017c-.163.002-1.006.039-1.983.705-.951-.648-1.774-.7-1.968-.704L12.002 2h-.004c-.801 0-1.555.313-2.119.878C9.313 3.445 9 4.198 9 5s.313 1.555.861 2.104l3.414 3.586a1.006 1.006 0 0 0 1.45-.001l3.396-3.568C18.688 6.555 19 5.802 19 5s-.313-1.555-.878-2.121A2.978 2.978 0 0 0 16.002 2H16zm1 3c0 .267-.104.518-.311.725L14 8.55l-2.707-2.843C11.104 5.518 11 5.267 11 5s.104-.518.294-.708A.977.977 0 0 1 11.979 4c.025.001.502.032 1.067.485.081.065.163.139.247.222l.707.707.707-.707c.084-.083.166-.157.247-.222.529-.425.976-.478 1.052-.484a.987.987 0 0 1 .701.292c.189.189.293.44.293.707z"></path></svg></a></div></div><div class="Navbar_search_icon_wrapper__1a_rL ml-5 dark:text-white"><button name="search-button" aria-label="search button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="dark:text-white text-black text-[22px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg></button></div><div class=""><button name="share" aria-label="share page"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="dark:text-white text-black text-[16px] mt-[7px] ml-2 mr-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"></path></svg></button></div><button name="theme-switch" aria-label="theme button" class="Navbar_theme_switch__q7F_Z pl-3 dark:text-white text-black"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-md " height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path></svg></button></div></div></nav><aside class="Navbar_nav_sidebar_wrapper__M0KaI dark:bg-slate-900 dark:text-white bg-white text-black"><div class="flex items-center justify-between pb-3"><p class="">МЕНЮ</p><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-slate-800 dark:text-white text-[25px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg></div></div><hr/><div class="my-15"><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/">Главная</a><div class="relative"><div class="flex items-center cursor-pointer justify-between"><p class="my-0">Блог</p><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-[20px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16.293 9.293 12 13.586 7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z"></path></svg></div><div class="overflow-auto relative h-0 border-0"><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2" href="/blog/"><span>Все публикации</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=.NET"><span style="text-transform:capitalize">.NET</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=PostgreSQL"><span style="text-transform:capitalize">PostgreSQL</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=DevOps"><span style="text-transform:capitalize">DevOps</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=SQL%20Server"><span style="text-transform:capitalize">SQL Server</span></a></div></div><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/instruments/">Инструменты</a><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/about/">Обо мне</a><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/contact/">Контакты</a></div><hr/><div class="my-5"><p class="font-light">Подписаться : </p> <a href="https://github.com/YPermitin/" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><a href="https://t.me/TinyDevVault" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg></a><a href="mailto:i.need.ypermitin@yandex.ru" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a><a href="https://boosty.to/ypermitin" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 21h9.62a3.995 3.995 0 0 0 3.037-1.397l5.102-5.952a1 1 0 0 0-.442-1.6l-1.968-.656a3.043 3.043 0 0 0-2.823.503l-3.185 2.547-.617-1.235A3.98 3.98 0 0 0 9.146 11H4c-1.103 0-2 .897-2 2v6c0 1.103.897 2 2 2zm0-8h5.146c.763 0 1.448.423 1.789 1.105l.447.895H7v2h6.014a.996.996 0 0 0 .442-.11l.003-.001.004-.002h.003l.002-.001h.004l.001-.001c.009.003.003-.001.003-.001.01 0 .002-.001.002-.001h.001l.002-.001.003-.001.002-.001.002-.001.003-.001.002-.001c.003 0 .001-.001.002-.001l.003-.002.002-.001.002-.001.003-.001.002-.001h.001l.002-.001h.001l.002-.001.002-.001c.009-.001.003-.001.003-.001l.002-.001a.915.915 0 0 0 .11-.078l4.146-3.317c.262-.208.623-.273.94-.167l.557.186-4.133 4.823a2.029 2.029 0 0 1-1.52.688H4v-6zM16 2h-.017c-.163.002-1.006.039-1.983.705-.951-.648-1.774-.7-1.968-.704L12.002 2h-.004c-.801 0-1.555.313-2.119.878C9.313 3.445 9 4.198 9 5s.313 1.555.861 2.104l3.414 3.586a1.006 1.006 0 0 0 1.45-.001l3.396-3.568C18.688 6.555 19 5.802 19 5s-.313-1.555-.878-2.121A2.978 2.978 0 0 0 16.002 2H16zm1 3c0 .267-.104.518-.311.725L14 8.55l-2.707-2.843C11.104 5.518 11 5.267 11 5s.104-.518.294-.708A.977.977 0 0 1 11.979 4c.025.001.502.032 1.067.485.081.065.163.139.247.222l.707.707.707-.707c.084-.083.166-.157.247-.222.529-.425.976-.478 1.052-.484a.987.987 0 0 1 .701.292c.189.189.293.44.293.707z"></path></svg></a><hr class="mt-5"/></div><div class="mt-5 mb-4"><p class="mb-2 font-light">Переключиться на <!-- -->светлую<!-- --> тему :</p><button name="theme-switch" aria-label="theme-switch" class="Navbar_theme_switch__q7F_Z dark:text-white text-black"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-lg" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path></svg></button></div><hr/><div class="my-5"><p class="text-sm font-light dark:text-gray-400 text-gray-500 mb-1">Copyright © 2024</p></div></aside><div class="transition-all fixed h-screen w-screen flex items-center justify-center left-0 z-20 top-0 pointer-events-none opacity-0"><div class="absolute top-0 left-0 w-screen h-screen bg-black opacity-50"></div><div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded lg:w-1/6 mx-3 w-full relative z-10 transition-all top-10"><div class="flex border-gray-300 pb-2 mb-3 border-b"><p class="  font-medium w-full">Share:</p><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div><div class="flex flex-wrap items-center"><a class="mr-3" aria-label="facebook-share" href="https://www.facebook.com/sharer/sharer.php?u=https://ypermitin.github.io" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-92.4 233.5h-63.9c-50.1 0-59.8 23.8-59.8 58.8v77.1h119.6l-15.6 120.7h-104V912H539.2V602.2H434.9V481.4h104.3v-89c0-103.3 63.1-159.6 155.3-159.6 44.2 0 82.1 3.3 93.2 4.8v107.9z"></path></svg></a><a class="mr-3" aria-label="twitter-share" href="http://twitter.com/share?text=Check out this article!! &amp;url=https://ypermitin.github.io&amp;hashtags=webdevelopment,javacript,javascriptdaily,webdevelopmenttutorial,tutorial" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm215.3 337.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 0 1-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 0 1-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 0 0 229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"></path></svg></a><a class="mr-3" aria-label="linkedin-share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ypermitin.github.io&amp;title=Check out this article!!&amp;source=LinkedIn" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[23px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><button class="mr-3" name="copy-link" aria-label="copy-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></button></div><div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded fixed flex transition-all right-[10px] -bottom-20 opacity-0" role="alert"><strong class="font-bold">Link Copied</strong><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div></div></div><section class="PageLayout_centered_article_wrapper__gS3Af dark:bg-slate-900 dark:text-white"><div class="container px-0 md:px-[15px] pt-[50px] pb-[50px]"><article class="PageLayout_article_content__4dnq3 pb-[30px] px-3 bg-white dark:bg-slate-800 dark:border-none dark:drop-shadow-lg dark:text-white pt-10 md:pt-0 mx-auto font-regular text-lg leading-relaxed"><div class="mb-[30px]"><h1 class="ArticleHeader_articleTitle__3L1Bi text-center text-2xl md:text-4xl font-medium mt-[20px] mb-[5px]">Эти занимательные временные таблицы</h1><div class="mb-[10px] mt-[15px] text-[14px] font-medium ArticleHeader_centered_article_header_author___gRtE"><p class="my-0 mx-[30px] font-medium">YPermitin<span class="px-1 font-light">в</span><a href="/blog/?category=SQL%20Server">SQL Server</a></p><p class="my-0">2019-11-28</p></div><div class="md:mt-2 flex flex-wrap justify-center"><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->SQL Server</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->1С:Предприятие</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->TempDB</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->временные таблицы</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->оптимизация</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->производительность</p></div></div><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Мы все их используем</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Не важно - новичок Вы или опытный разработчик. Если когда-либо в работе приходилось создавать запросы, то с высокой долей вероятности в них хотя бы раз были использованы временные таблицы. Тот же экзамен “1С:Специалист по платформе” фактически требует их использования при решении задач на экзамене. Сегодня речь будет идти, внезапно, как-раз о временных таблицах и работе платформы 1С с ними.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Мы начнем с простых примеров работы с временными таблицами и действиями платформы на стороне СУБД. А закончим чем-то очень странным и неожиданным.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Примитивный пример</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Временные таблицы рекомендуется использовать для создания стабильных и производительных запросов. В тексте запросов их создание выполняется с помощью ключевого слова “ПОМЕСТИТЬ” для пакета запроса.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-lnsjTu sc-iKOmoZ fEBwLT jtELGb prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ ПЕРВЫЕ </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Наименование КАК Наименование</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Справочник</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Наименование КАК Наименование</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain">                              </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура КАК ВТ_Номенклатура</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Здесь в первом пакете запросов мы выбрали первые 100 элементов справочника “Номенклатура” и поместили их во временную таблицу “ВТ_Номенклатура”. После чего во втором пакете мы получили данные из ранее созданной временной таблицы и вернули их как результат выборки. Все просто, не так ли?</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Если взглянуть на происходящее на стороне СУБД, то мы увидим следующую серию запросов.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-gjLLEI sc-eAKtBH cQwhwI cKwMpP prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt36&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36 (</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    _Q_000_F_000RRef </span><span class="token keyword" style="color:rgb(86, 156, 214)">BINARY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    _Q_000_F_001 NVARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">COLLATE</span><span class="token plain"> DATABASE_DEFAULT</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 1 пакета запроса для заполнения временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36 WITH(TABLOCK) (_Q_000_F_000RRef, _Q_000_F_001) SELECT TOP 100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Description</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Неявный отбор по разделителю данных</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Получение данных из временной таблицы для результата запроса</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_001</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36 T1 WITH(NOLOCK)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Тоже все относительно просто. Платформа 1С выполняет ряд простых шагов:</p><ul class="List_list__zLjGi list-disc pl-[30px]"><li>Проверка наличия временной таблицы с зарезервированным именем. Если существует, то будет удалена.</li><li>Создание временной таблицы.</li><li>Далее выполняет запрос из первого пакета для наполнения данных ранее созданной временной таблицы.</li><li>Вторым запросом получает данные из временной таблицы для результата выборки.</li><li>Очищает данные временной таблицы.</li></ul><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В нашем случае последней операцией является очистка временной таблицы, причем платформа делает это автоматически. Так происходит, потому что запрос был окончательно выполнен и за ним можно освободить ресурсы. Очистку данных временной таблицы также можно добавить явно указав инструкции в запросе:</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-bZHSRq sc-kMzELR dsiBp jGagcB prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">УНИЧТОЖИТЬ ВТ_Номенклатура</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Всегда ли платформа действует по таким правилам? Нет. Например, если выполнить этот же запрос еще раз, то количество выполняемых SQL-запросов будет меньше.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-ilxebA sc-jIBlqr aGqaq imMmWk prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 1 пакета запроса для заполнения временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36 WITH(TABLOCK) (_Q_000_F_000RRef, _Q_000_F_001) SELECT TOP 100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Description</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Неявный отбор по разделителю данных				</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Получение данных из временной таблицы для результата запроса</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_001</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36 T1 WITH(NOLOCK)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt36</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Платформа увидела, что пустая временная таблица с необходимой структурой уже есть на стороне базы данных для текущего соединения с СУБД и не стала создавать ее заново. Эта оптимизация позволяет работать с временными таблицами наиболее эффективно, не создавая каждый раз их заново.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Также обратите внимание на проверку существования временной таблицы выше. Ранее редко, но метко, можно было нарваться на ошибку уже существующей временной таблицы с именем “#ttN`. Помню такое еще со времен 8.3.6. Теперь это более редкая проблема и это поведение одна из причин изменения ситуации.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Итак, создание временных таблиц выполняется довольно просто. Это относится как в части использования конструкции “ПОМЕСТИТЬ” в запросе, так и в части SQL-запросов платформы 1С. Даже переиспользование ранее созданных временных таблиц не усложняет пример. Но все ли так просто на самом деле?</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Серийное производство</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Усложним пример и создадим намного больше временных таблиц в запросе. Вот как это выглядит в контексте 1С.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-hhyKGa sc-gYrqIg btpbcN jOFoYp prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ ПЕРВЫЕ </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ПОМЕСТИТЬ ВТ_Номенклатура_1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Справочник</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ИНДЕКСИРОВАТЬ </span><span class="token keyword" style="color:rgb(86, 156, 214)">ПО</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ ПЕРВЫЕ </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ПОМЕСТИТЬ ВТ_Номенклатура_2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Справочник</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ИНДЕКСИРОВАТЬ </span><span class="token keyword" style="color:rgb(86, 156, 214)">ПО</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ ПЕРВЫЕ </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Номенклатура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ПОМЕСТИТЬ ВТ_Номенклатура_3</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Справочник</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ИНДЕКСИРОВАТЬ </span><span class="token keyword" style="color:rgb(86, 156, 214)">ПО</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура_3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка КАК Ссылка3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ПОМЕСТИТЬ ВТ_Результат</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Номенклатура_1 КАК ВТ_Номенклатура_1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Номенклатура_2 КАК ВТ_Номенклатура_2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">			ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Номенклатура_3 КАК ВТ_Номенклатура_3</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">			</span><span class="token keyword" style="color:rgb(86, 156, 214)">ПО</span><span class="token plain"> ВТ_Номенклатура_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ВТ_Номенклатура_3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">		</span><span class="token keyword" style="color:rgb(86, 156, 214)">ПО</span><span class="token plain"> ВТ_Номенклатура_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ВТ_Номенклатура_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">УНИЧТОЖИТЬ ВТ_Номенклатура_1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">УНИЧТОЖИТЬ ВТ_Номенклатура_2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">УНИЧТОЖИТЬ ВТ_Номенклатура_3</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">////////////////////////////////////////////////////////////////////////////////</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка1 КАК Ссылка1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка2 КАК Ссылка2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Ссылка3 КАК Ссылка3</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ИЗ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ВТ_Результат КАК ВТ_Результат</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Длинный запрос. В этом примере мы создали 3 временных таблицы, соединили их и результат поместили в четвертую, а после удалили часть временных таблиц и вернули результат. При этом для первых трех таблиц мы добавили индексы. Вот что мы увидим на стороне SQL Server.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-cCzLxZ sc-ckdEwu epWpyp iuXQnR prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt41&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы &quot;ВТ_Номенклатура_1&quot; с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt41 (_Q_000_F_000RRef BINARY(16), _Q_000_F_001 NUMERIC(1, 0))					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание кластерного индекса для временной таблицы &quot;ВТ_Номенклатура_1&quot; по полю &quot;Ссылка&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CLUSTERED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INDEX</span><span class="token plain"> idx41 </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt41 (_Q_000_F_000RRef)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 1 пакета запроса для заполнения временной таблицы &quot;ВТ_Номенклатура_1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt41 WITH(TABLOCK) (_Q_000_F_000RRef, _Q_000_F_001) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TOP</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt42&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы &quot;ВТ_Номенклатура_2&quot; с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt42 (_Q_001_F_000RRef BINARY(16), _Q_001_F_001 NUMERIC(1, 0))					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание кластерного индекса для временной таблицы &quot;ВТ_Номенклатура_2&quot; по полю &quot;Ссылка&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CLUSTERED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INDEX</span><span class="token plain"> idx42 </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt42 (_Q_001_F_000RRef)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 2 пакета запроса для заполнения временной таблицы &quot;ВТ_Номенклатура_2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt42 WITH(TABLOCK) (_Q_001_F_000RRef, _Q_001_F_001) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TOP</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt43&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы &quot;ВТ_Номенклатура_3&quot; с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt43 (_Q_001_F_000RRef BINARY(16), _Q_001_F_001 NUMERIC(1, 0))					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание кластерного индекса для временной таблицы &quot;ВТ_Номенклатура_3&quot; по полю &quot;Ссылка&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CLUSTERED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INDEX</span><span class="token plain"> idx43 </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt43 (_Q_001_F_000RRef)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 3 пакета запроса для заполнения временной таблицы &quot;ВТ_Номенклатура_3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt43 WITH(TABLOCK) (_Q_001_F_000RRef, _Q_001_F_001) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TOP</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt44&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы &quot;ВТ_Результат&quot; с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt44 (_Q_001_F_000RRef BINARY(16), _Q_001_F_001RRef BINARY(16), _Q_001_F_002RRef BINARY(16), _Q_001_F_003 NUMERIC(1, 0))					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 4 пакета запроса для заполнения временной таблицы &quot;ВТ_Результат&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt44 WITH(TABLOCK) (_Q_001_F_000RRef, _Q_001_F_001RRef, _Q_001_F_002RRef, _Q_001_F_003) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt41 T1 WITH(NOLOCK)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">LEFT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OUTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt42 T2 WITH(NOLOCK)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">LEFT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OUTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt43 T3 WITH(NOLOCK)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> T3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_000RRef </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> T2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы &quot;ВТ_Номенклатура_1&quot; c помощью конструкции &quot;УНИЧТОЖИТЬ&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt41					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы &quot;ВТ_Номенклатура_2&quot; c помощью конструкции &quot;УНИЧТОЖИТЬ&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt42					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы &quot;ВТ_Номенклатура_3&quot; c помощью конструкции &quot;УНИЧТОЖИТЬ&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt43</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Получение данных из временной таблицы для результата запроса</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_001RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_001_F_002RRef</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt44 T1 WITH(NOLOCK)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка временной таблицы ВТ_Результат после выполнения запроса</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt44</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Главным отличием от предыдущего примера является большее количество временных таблиц и манипуляций с ними. При этом принципы работы те же самые. Из нового стоит выделить создание индекса для временных таблиц. Фактически, это всегда кластерный индекс по указанному набору полей. Стоит ли всегда создавать индексы на временную таблицу? Если кратко, то “НЕТ”. Добавлять индексы во временную таблицу нужно только при большом объеме данных и только на те поля, которые используются в соединениях или условиях отборов. И если при подготовке к экзаменам Вам говорят, что для временных таблиц всегда нужно добавлять индексы, то скорее всего это только в контексте экзамена.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В этом примере мы также рассмотрели как работает конструкции “УНИЧТОЖИТЬ”. Фактически она также очищает существующую временную таблицу как это делает платформа автоматически при завершении запроса. Давайте пройдем дальше.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Самый лучший менеджер</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Настало время еще более сложных примеров. Ранее мы создавали 3 временных таблицы в одном пакетном запросе. Платформе 1С также позволяет использовать менеджер временных таблиц, тем самым сохраняя временную таблицу между вызовами запросов. Этот прием часто используется при наличии сложной логики запросов к базе данных. Как же платформа работает с этим механизмом?</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-jdHILj sc-cbDaos kMJfNM cFzsSm prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Подготовим текст запроса</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ТекстЗапроса </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ ПЕРВЫЕ 1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	1 КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;ПРОВЕРКА&quot;&quot; КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;Тест&quot;&quot; КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Справочник.Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИНДЕКСИРОВАТЬ ПО</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Ссылка&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Выполним запрос и поместим результат во временную таблицу.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Для сохранения временной таблицы используем менеджер временных таблиц.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">МенеджерВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> МенеджерВременныхТаблиц</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ТекстЗапроса</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Прочитаем данные из временной таблицы в менеджере ВТ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ * Из ВТ_Номенклатура КАК Т&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Результат </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">		</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Выбрать</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Следующий</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Сообщить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">НомерМенеджераВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Очищаем данные менеджера временных таблиц</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Закрыть</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Здесь мы создали менеджер временных таблиц и присвоили его первому объекту запроса. Текст первого запроса написан таким образом, чтобы результат поместить во временную таблицу “ВТ_Номенклатура”. Затем мы создали новый экземпляр запроса и прочитали данные из временной таблицы “ВТ_Номенклатура”, которую сформировали ранее. Обращение к существующей временной таблице как-раз и возможно благодаря менеджеру временных таблиц. В завершении мы очистили все сохраненные данные в контексте менеджера ВТ. На стороне SQL Server это выглядит так.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-iVheDh sc-iCKXBC kmbIqv cQLRfO prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Проверка существует ли временная таблица с указанным именем</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> OBJECT_ID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;tempdb..#tt50&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">IS</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание временной таблицы с зарезервированным именем и необходимой структурой</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt50 (</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        _Q_000_F_000RRef </span><span class="token keyword" style="color:rgb(86, 156, 214)">BINARY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        _Q_000_F_001 </span><span class="token keyword" style="color:rgb(86, 156, 214)">NUMERIC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        _Q_000_F_002 NVARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">COLLATE</span><span class="token plain"> DATABASE_DEFAULT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        _Q_000_F_003 </span><span class="token keyword" style="color:rgb(86, 156, 214)">BINARY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">					</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Создание кластерного индекса для временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CLUSTERED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INDEX</span><span class="token plain"> idx50 </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt50 (_Q_000_F_000RRef)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 1 запроса для заполнения временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt50 WITH(TABLOCK) (_Q_000_F_000RRef, _Q_000_F_001, _Q_000_F_002, _Q_000_F_003) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TOP</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">@P2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">0x01</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> dbo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Reference85 T1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Fld774 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@P3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Выполнение 2 запроса для чтения данных из временной таблицы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_000RRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_001</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_002</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">_Q_000_F_003</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt50 T1 WITH(NOLOCK)					</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Очистка данных в контексте менеджера временных таблиц</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">TRUNCATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#tt50</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Фактически, если выполнить все запросы без менеджера временных таблиц одним пакетом, то сформированные SQL-запросы будут те же самые.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-egTsrv sc-cSxRuM ebgOAc eqEgMU prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">ТекстЗапроса </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ ПЕРВЫЕ 1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	1 КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;ПРОВЕРКА&quot;&quot; КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;Тест&quot;&quot; КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Справочник.Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИНДЕКСИРОВАТЬ ПО</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Ссылка</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|////////////////////////////////////////////////////////////////////////////////</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ВЫБРАТЬ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	ВТ_Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	ВТ_Номенклатура.НомерМенеджераВТ КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	ВТ_Номенклатура.ПроизвольныйТекст КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	ВТ_Номенклатура.ДругоеЗначение КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	ВТ_Номенклатура КАК ВТ_Номенклатура&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ТекстЗапроса</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Результат </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">		</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Выбрать</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Следующий</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Сообщить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">НомерМенеджераВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Таким образом, с помощью менеджера временных таблиц можно создать один раз временную таблицу и использовать ее в других запросах многократно. Удобно, эффективно, производительно. В типовых конфигурациях это используется повсеместно. Но есть интересные особенности как платформа 1С работает с временными таблицами при многопользовательской работе.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Срывая покровы</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Еще несколько очевидных и не очень особенностей работы с временными таблицами.</p><h2 class="font-semibold text-xl md:text-2xl my-[10px] mt-10 md:text" style="text-align:unset">Контекст и контроль доступности</h2><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Как известно, сервер 1С при работе с СУБД имеет пул соединений. Речь идет именно о пуле соединений с СУБД, а не кластером 1С. У Вас может быть 100 активных сеансов работы с информационной базой и 2 запущенных рабочих процесса (rphost’ы), но при этом соединений со SQL Server может быть 15. На каждый рабочий процесс свой пул соединений. Это все очень условно, но смысл должен быть понятен. То есть количество сеансов НЕ равно количеству соединений с базой данных. Использование пула соединений является очень эффективным и производительным подходом и тут все просто отлично.</p><div class="Images_article_image__wrapper__QSTzx my-4 Images_size_medium__0iTcB display-block mx-auto my-5"><div aria-owns="rmiz-modal-" data-rmiz=""><div data-rmiz-content="not-found" style="visibility:visible"><img src="/imp_assets/SQLServer/2020-04/fun-temporary-tables/1. Схема соединений и рабочих процессов.png" alt="Схема соединений и рабочих процессов" width="100%" class="block"/></div></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Есть еще один нюанс. Создаваемые платформой 1С временные таблицы являются локальными. То есть они доступны только в рамках одного соединения с СУБД. Есть также и глобальные временные таблицы, но платформа их не использует. Таким образом, создание и использование временной таблицы происходит всегда в рамках одного соединения с СУБД.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Последнее еще интересней, если рассмотреть это в рамках использования менеджера временных таблиц. Если из кода встроенного языка создать менеджер временных таблиц и выполнять запросы с присвоением этого менеджера ВТ объекту запроса, то можно быть уверенным, что все они будут выполнены в рамках одного соединения с СУБД.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Тут может показаться, что если в разных сеансах 1С создать менеджер временных таблиц, а в нем сохранить временную таблицу с одним названием, допустим, “ВТ_Номенклатура”, то эта таблица будет доступна в разных сеансах, если они используют одно соединение с СУБД. На самом деле нет, т.к. платформа еще и сама контролирует доступность временных таблиц в разрезе сеансов и доступность в зависимости от контекста.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-jMbVJB sc-dQmiwx jRzFBK iDQWAs prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Код сеанса 1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">МенеджерВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> МенеджерВременныхТаблиц</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ТекстЗапроса </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ ПЕРВЫЕ 1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	1 КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;ПРОВЕРКА&quot;&quot; КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	33 КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Справочник.Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИНДЕКСИРОВАТЬ ПО</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Ссылка&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ТекстЗапроса</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div></div><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-bCvmQg sc-cPtzlb lgkwgp gAoMrd prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Код сеанса 2</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">МенеджерВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> МенеджерВременныхТаблиц</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">				</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ * Из ВТ_Номенклатура КАК Т&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Результат </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Результат</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Выбрать</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Следующий</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Сообщить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Выборка</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">НомерМенеджераВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Во втором сеансе будет ошибка:</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-BCDEK sc-kiTBBF gWxBoy cnHDOK prism-code language-text" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Таблица не найдена &quot;ВТ_Номенклатура&quot;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">ВЫБРАТЬ * Из &lt;&lt;?&gt;&gt;ВТ_Номенклатура КАК Т</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">И это логично. Дело даже не в том, что это разные сеансы, а в том что это разные менеджеры временных таблиц. Использовать один менеджер временных таблиц в разных сеансах платформа не позволяет, а контроль доступности осуществляется именно в контексте менеджера ВТ.</p><h2 class="font-semibold text-xl md:text-2xl my-[10px] mt-10 md:text" style="text-align:unset">Кэширование</h2><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Вы когда-нибудь кэшировали менеджер временных таблиц? В некоторых особых случаях Вы могли бы увидеть вот это.</p><div class="Images_article_image__wrapper__QSTzx my-4 Images_size_medium__0iTcB display-block mx-auto my-5"><div aria-owns="rmiz-modal-" data-rmiz=""><div data-rmiz-content="not-found" style="visibility:visible"><img src="/imp_assets/SQLServer/2020-04/fun-temporary-tables/2. Ошибка менеджера временных таблиц.png" alt="Ошибка менеджера временных таблиц" width="100%" class="block"/></div></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Текст ошибки:</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-hVcFVo sc-jiaSqj kzFeqj hhHots prism-code language-text" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">Ошибка конфигурации.</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Соединение с сервером баз данных удерживается после окончания вызова сервера 1С:Предприятия.</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Возможно, не был освобожден менеджер временных таблиц.</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Объект, удерживающий менеджер временных таблиц, помещен в кэш или образовал цепочку</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">циклических ссылок.&quot;</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Как мы уже говорили выше, для работы менеджера временных таблиц резервируется конкретное соединение с СУБД. Пока менеджер временных таблиц существует, в переменной или в другом кэшированном виде, то для него зарезервировано соединение. Если по каким-либо причинам, например из-за циклических ссылок, платформа не сможет удалить менеджер ВТ и освободить соединение с базой данных, то появится именно такая ошибка. Вы можете воспроизвести ее самостоятельно вот таким образом.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-gUjWJS sc-kZOsHZ hgCCwf izdKHN prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token directive important">&amp;НаКлиенте</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">Процедура</span><span class="token plain"> ОшибкаКэшированияВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Команда</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ОшибкаКэшированияВТНаСервере</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">КонецПроцедуры</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token directive important">&amp;НаСервере</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">Процедура</span><span class="token plain"> ОшибкаКэшированияВТНаСервере</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token comment" style="color:rgb(106, 153, 85)">// Инициализируем менеджер временных таблиц и выполняем запрос в его контексте</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	МенеджерВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> МенеджерВременныхТаблиц</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	ТекстЗапроса </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">		</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ ПЕРВЫЕ 1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	1 КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	&quot;&quot;ПРОВЕРКА&quot;&quot; КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	33 КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	Справочник.Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|ИНДЕКСИРОВАТЬ ПО</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">		|	Ссылка&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> ТекстЗапроса</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token comment" style="color:rgb(106, 153, 85)">// Эмулируем появление циклической ссылки, чтобы после завершения серверного </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token comment" style="color:rgb(106, 153, 85)">// вызова платформа не смогла удалить менеджер ВТ</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш1 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Структура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Вставить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;МенеджерВТ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Вставить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;СсылкаНаДругойКэш&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Неопределено</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш2 </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Структура</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Вставить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;МенеджерВТ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Вставить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;СсылкаНаДругойКэш&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Неопределено</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">СсылкаНаДругойКэш </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Кэш2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Кэш2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">СсылкаНаДругойКэш </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Кэш1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">КонецПроцедуры</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Как этого избежать? Нужно следовать простым правилам:</p><ul class="List_list__zLjGi list-disc pl-[30px]"><li>НЕ кэшировать менеджер временных таблиц там, где кэш сохраняется между вызовами сервера.</li><li>Быть осторожным с циклическими ссылками. В принципе, это относится не только к менеджеру ВТ, но и к любой разработке.</li><li>Вместо кэширования менеджера ВТ подумать над архитектурой. * Возможно кэшируемые в ВТ данные требуют особого хранения в базе для быстрого доступа.</li></ul><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Вот даже с таким можно встретиться.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Утопи меня в соединениях</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">И еще один эксперимент. Для каждого менеджера ВТ резервируются соединения с СУБД. Это мы уже говорили. Но это не значит, что на каждый созданный менеджер создается соединение с базой данных. Для эксперимента выполните в одном сеансе вот такой код.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-iLXxbI sc-jgraLO iZZNNP hrVIPL prism-code language-bsl" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain">ТекстЗапроса </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ВЫБРАТЬ ПЕРВЫЕ 1</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Номенклатура.Ссылка КАК Ссылка,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	1 КАК НомерМенеджераВТ,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	&quot;&quot;ПРОВЕРКА&quot;&quot; КАК ПроизвольныйТекст,</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	33 КАК ДругоеЗначение</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ПОМЕСТИТЬ ВТ_Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИЗ</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Справочник.Номенклатура КАК Номенклатура</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|ИНДЕКСИРОВАТЬ ПО</span></div><div class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">	|	Ссылка&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">КэшМенеджеровВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Соответствие</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">Для</span><span class="token plain"> НомерМенеджера </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">По</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10000</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Цикл</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	МенеджерВТ </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> МенеджерВременныхТаблиц</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Новый</span><span class="token plain"> Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Текст </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> СтрЗаменить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ТекстЗапроса</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">			</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;1 КАК НомерМенеджераВТ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">			XMLСтрока</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">НомерМенеджера</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot; КАК НомерМенеджераВТ&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">МенеджерВременныхТаблиц </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	Запрос</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">Выполнить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	КэшМенеджеровВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Вставить</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">НомерМенеджера</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> МенеджерВТ</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">КонецЦикла</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Мы создали 10000 новых временных таблиц и менеджеров ВТ! Вы можете это проверить и на стороне СУБД с помощью скриптов, предложенных в конце статьи. Там же есть и скрипты для просмотра количества соединений с сервером баз данных. При этом новых соединений на каждый менеджер ВТ платформа не создала. Все потому что для обслуживания одного сеанса достаточно одного соединения с базой данных. Возможно, для этого правила есть исключения, но мы их сейчас рассматривать не будем.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Как сервер 1С заставить создать дополнительные соединения с БД? Откройте 10 сеансов 1С и запустите этот код в каждом сеансе. Барабанная дробь! Сервер 1С увеличит пул соединений с СУБД до 10 сеансов (может и больше, если ранее соединения уже были созданы). При этом стоит заметить, что пул соединений увеличивается не сразу после старта сеанса 1С, а именно во время создания менеджеров временных таблиц в каждом сеансе. Главное запустить этот код параллельно.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Таким образом, использование временных таблиц и менеджера ВТ может напрямую влиять на размер пула соединений сервера 1С с сервером баз данных.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Только не устраивайте этот спам временными таблицами на рабочем окружении. Поберегите сервер!</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Покажи мне свой товар</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Как мы уже говорили ранее, локальная временная таблица (именно такие используются платформой 1С) на уровне СУБД доступны только тому соединению, в рамках которого она была создана. Мы никак не можем прочитать из одного соединения содержимое таблиц другого соединения. Например, Вы с помощью диагностических запросов нашли, что таблица “#tt555” участвует в подозрительном запросе и захотели посмотреть что в ней находится. Но SQL Server не позволит это сделать. Но, как говорится, если сильно хочется, то можно. И вот как!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Для наглядности мы будем немного изменять тексты запросов, которые генерирует платформа. Это только для наглядности. Все что Вы увидите ниже можно применять и на практике. И так, допустим платформа создала временную таблицу и наполнила ее данными во таким способом.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-eKzvBH sc-ppzwM kTgxvp eABuRi prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#ttTest (</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    column1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">BINARY</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    column2 NVARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">COLLATE</span><span class="token plain"> DATABASE_DEFAULT</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">#ttTest WITH(TABLOCK) (column1, column2) </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">0x811FA45D36C581E411E8F9DCD58AB12F</span><span class="token plain"> AS_IDRRef</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Этот текст должен видеть только администратор!&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> _Description</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">С помощью этого скрипта мы можем узнать где именно эта временная таблица хранится в базе TempDB вплоть до адреса страниц в файле базы данных.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-hiTDLB sc-ejCKsa hqYaQm eoCZoP prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">first_page</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">data_pages</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token keyword" style="color:rgb(86, 156, 214)">rows</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">tables</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> T</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partitions </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> P</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">system_internals_allocation_units </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> AU</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;IN_ROW_DATA&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ROW_OVERFLOW_DATA&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;LOB_DATA&#x27;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">hobt_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">LIKE</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;#ttTest%&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Здесь отбор по имени временной таблицы</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Предположим, что результат мы получили следующий.</p><div class="flex flex-col relative gap-4 w-full"><div class="p-4 z-0 flex flex-col relative justify-between gap-4 bg-content1 overflow-auto rounded-large shadow-small w-full"><table aria-label="Состояние индексов" id="react-aria-:R8ueq6:" role="grid" tabindex="0" aria-describedby="" class="min-w-full h-auto table-auto w-full"><thead class="[&amp;&gt;tr]:first:rounded-lg" role="rowgroup"><tr role="row" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><th tabindex="-1" data-key="c1" role="columnheader" id="react-aria-:R8ueq6:-c1" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Имя временной таблицы</th><th tabindex="-1" data-key="c2" role="columnheader" id="react-aria-:R8ueq6:-c2" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Идентификатор объекта</th><th tabindex="-1" data-key="c3" role="columnheader" id="react-aria-:R8ueq6:-c3" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Тип данных</th><th tabindex="-1" data-key="c4" role="columnheader" id="react-aria-:R8ueq6:-c4" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Адрес первой страницы</th><th tabindex="-1" data-key="c5" role="columnheader" id="react-aria-:R8ueq6:-c5" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Количество страниц с данными</th><th tabindex="-1" data-key="c6" role="columnheader" id="react-aria-:R8ueq6:-c6" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Количество записей в таблице</th></tr><tr tabindex="-1" aria-hidden="true" class="w-px h-px block" style="margin-left:0.25rem;margin-top:0.25rem"></tr></thead><tbody role="rowgroup"><tr data-first="true" data-last="true" role="row" tabindex="-1" data-key="1" aria-labelledby="react-aria-:R8ueq6:-1-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="1.0" role="rowheader" id="react-aria-:R8ueq6:-1-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>#ttTest______00000000EAFD</span></td><td tabindex="-1" data-key="1.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>-1137577394</span></td><td tabindex="-1" data-key="1.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>IN_ROW_DATA</span></td><td tabindex="-1" data-key="1.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0x481E01000800</span></td><td tabindex="-1" data-key="1.4" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>1</span></td><td tabindex="-1" data-key="1.5" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>1</span></td></tr></tbody></table></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Очень интересно <!-- -->:)<!-- --> Но что же это значит? Расшифруем.</p><ul class="List_list__zLjGi list-decimal pl-[30px]"><li>Имя временной таблицы (name) - это полное имя временной таблицы с учетом идентификатора соединения с базой данных. Именно благодаря такому формированию имени можно создавать временные таблицы с одинаковым именем в разных сессиях, т.к. по факту имена у них все же будут отличаться. Хоть последнее и не будет заметно при их использовании.</li><li>Идентификатор объекта (object_id) - идентификатор объекта временной таблицы.</li><li>Тип данных (type_desc) - какие данные хранятся в этом объекте. В нашем случае это таблица с записями.</li><li>Адрес первой страницы (first_page) - адрес первой страницы. Это важная часть нашего эксперимента. В нашем случае это значение “0x481E01000800”. Сохранен в виде 6 байтового значения, где каждый байт представлен двумя шестнадцатеричными символами. Для расшифровки нужно читать его справа на лево. Если его расшифровать, то получим следующее (для конвертации hex в число можно использовать этот сервис):<ul class="List_list__zLjGi list-disc pl-[30px]"><li>00 08 - это идентификатор файла базы данных TempDB, где эта таблица сохранения. В нашем случае это 8.</li><li>00 01 1E 48 - это идентификатор начальной страницы. В нашем случае это 73288.</li></ul></li><li>Количество страниц с данными (data_pages) - сколько страниц по 8 КБ занимает таблица.</li><li>Количество записей в таблице (rows) - сколько записей во временной таблице.</li></ul><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Это все данные что нам нужны для получения содержимого таблицы из другой сессии. Теперь выполним следующий скрипт, подставив найденные параметры.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-ldgOGP sc-gHWSBU jdQQNW ghNfCy prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">DBCC</span><span class="token plain"> TRACEON </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3604</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Вывод сообщений</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- Служебная процедура для работы со страницами</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- https://www.mssqltips.com/sqlservertip/1578/using-dbcc-page-to-examine-sql-server-table-and-index-data/</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">DBCC</span><span class="token plain"> PAGE </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- база данных</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">8</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Идентификатор файла</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">73288</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Идентификатор начальной страницы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Как отобразить результат</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WITH</span><span class="token plain"> TABLERESULTS</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Возвращаем результат в таблицу</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В ответ мы получили большое количество записей. Вот последние 8. Остальные записи вида “BUFFER:” и “PAGE HEADER:” нас не интересуют, сразу перейдем к данным.</p><div class="flex flex-col relative gap-4 w-full"><div class="p-4 z-0 flex flex-col relative justify-between gap-4 bg-content1 overflow-auto rounded-large shadow-small w-full"><table aria-label="Внутренние данные временной таблицы" id="react-aria-:R9meq6:" role="grid" tabindex="0" aria-describedby="" class="min-w-full h-auto table-auto w-full"><thead class="[&amp;&gt;tr]:first:rounded-lg" role="rowgroup"><tr role="row" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><th tabindex="-1" data-key="c1" role="columnheader" id="react-aria-:R9meq6:-c1" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">ParentObject</th><th tabindex="-1" data-key="c2" role="columnheader" id="react-aria-:R9meq6:-c2" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Object</th><th tabindex="-1" data-key="c3" role="columnheader" id="react-aria-:R9meq6:-c3" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">Field</th><th tabindex="-1" data-key="c4" role="columnheader" id="react-aria-:R9meq6:-c4" class="group px-3 h-10 text-left align-middle bg-default-100 whitespace-nowrap text-foreground-500 text-tiny font-semibold first:rounded-l-lg last:rounded-r-lg data-[sortable=true]:transition-colors data-[sortable=true]:cursor-pointer data-[hover=true]:text-foreground-400 outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2">VALUE</th></tr><tr tabindex="-1" aria-hidden="true" class="w-px h-px block" style="margin-left:0.25rem;margin-top:0.25rem"></tr></thead><tbody role="rowgroup"><tr data-first="true" role="row" tabindex="-1" data-key="1" aria-labelledby="react-aria-:R9meq6:-1-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="1.0" role="rowheader" id="react-aria-:R9meq6:-1-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="1.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="1.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="1.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000000000000000: 30001400 811fa45d 36c581e4 11e8f9dc d58ab12f 0….¤]6Åä.èùÜÕŠ±/</span></td></tr><tr data-middle="true" data-odd="true" role="row" tabindex="-1" data-key="2" aria-labelledby="react-aria-:R9meq6:-2-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="2.0" role="rowheader" id="react-aria-:R9meq6:-2-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="2.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="2.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="2.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000000000000014: 02000001 0077002d 0442043e 04420420 00420435 …..w.-.B.&gt;.B. .B.5</span></td></tr><tr data-middle="true" role="row" tabindex="-1" data-key="3" aria-labelledby="react-aria-:R9meq6:-3-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="3.0" role="rowheader" id="react-aria-:R9meq6:-3-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="3.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="3.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="3.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000000000000028: 043a0441 04420420 0034043e 043b0436 0435043d .:.A.B. .4.&gt;.;.6.5.=</span></td></tr><tr data-middle="true" data-odd="true" role="row" tabindex="-1" data-key="4" aria-labelledby="react-aria-:R9meq6:-4-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="4.0" role="rowheader" id="react-aria-:R9meq6:-4-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="4.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="4.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="4.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>000000000000003C: 04200032 04380434 04350442 044c0420 0042043e . .2.8.4.5.B.L. .B.&gt;</span></td></tr><tr data-middle="true" role="row" tabindex="-1" data-key="5" aria-labelledby="react-aria-:R9meq6:-5-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="5.0" role="rowheader" id="react-aria-:R9meq6:-5-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="5.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="5.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="5.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000000000000050: 043b044c 043a043e 04200030 0434043c 0438043d .;.L.:.&gt;. .0.4.&lt;.8.=</span></td></tr><tr data-middle="true" data-odd="true" role="row" tabindex="-1" data-key="6" aria-labelledby="react-aria-:R9meq6:-6-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="6.0" role="rowheader" id="react-aria-:R9meq6:-6-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="6.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Memory Dump @0x0000003EC487A060</span></td><td tabindex="-1" data-key="6.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="6.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000000000000064: 04380441 04420440 04300442 043e0440 042100 .8.A.B.@.0.B.&gt;.@.!.</span></td></tr><tr data-middle="true" role="row" tabindex="-1" data-key="7" aria-labelledby="react-aria-:R9meq6:-7-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="7.0" role="rowheader" id="react-aria-:R9meq6:-7-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="7.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>column1 = [Binary data] Slot 0 Column 1 Offset 0x4 Length 16 Length (physical) 16</span></td><td tabindex="-1" data-key="7.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span> </span></td><td tabindex="-1" data-key="7.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>0000003EC487A064: 811fa45d 36c581e4 11e8f9dc d58ab12f .¤]6Åä.èùÜÕŠ±/</span></td></tr><tr data-last="true" data-odd="true" role="row" tabindex="-1" data-key="8" aria-labelledby="react-aria-:R9meq6:-8-c1" class="group outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2"><td tabindex="-1" data-key="8.0" role="rowheader" id="react-aria-:R9meq6:-8-c1" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Offset 0x60 Length 119</span></td><td tabindex="-1" data-key="8.1" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Slot 0 Column 2 Offset 0x1b Length 92 Length (physical) 92</span></td><td tabindex="-1" data-key="8.2" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>column2</span></td><td tabindex="-1" data-key="8.3" role="gridcell" class="py-2 px-3 relative align-middle whitespace-normal text-small font-normal [&amp;&gt;*]:z-1 [&amp;&gt;*]:relative outline-none data-[focus-visible=true]:z-10 data-[focus-visible=true]:outline-2 data-[focus-visible=true]:outline-focus data-[focus-visible=true]:outline-offset-2 before:content-[&#x27;&#x27;] before:absolute before:z-0 before:inset-0 before:opacity-0 data-[selected=true]:before:opacity-100 group-data-[disabled=true]:text-foreground-300 before:bg-default/40 data-[selected=true]:text-default-foreground first:before:rounded-l-lg last:before:rounded-r-lg"><span>Этот текст должен видеть только администратор!</span></td></tr></tbody></table></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В предпоследней строке с описанием “column1 = [Binary data] Slot 0 Column 1 Offset 0x4 Length 16 Length (physical) 16” содержится значение идентификатора в первой колонке “811fa45d 36c581e4 11e8f9dc d58ab12f”. В последней строке с описанием “Slot 0 Column 2 Offset 0x1b Length 92 Length (physical) 92” содержится значение второй колонки “Этот текст должен видеть только администратор!”.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Дело сделано! Мы прочитали содержимое временной таблицы другой сессии. Да, это не очень удобно в таком виде получать содержимое таблицы с большим количеством записей. Но здесь был продемонстрирован принцип, а инструменты для удобства можно создавать отдельно. Также есть и еще одно важное ограничение: использовать служебную процедуру “PAGE” можно только с правами “sysadmin”. Это стоит учитывать в работе. То есть этот способ доступен только для администратора или разработчика с соответствующими правами.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">А Вам слабо? <!-- -->:)</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">И немного диагностики</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Выше не раз упоминались некоторые скрипты, которые использовались для получения данных о временных таблицах. Продублируем их здесь для удобства.</p><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-cmfnrN sc-faxByu kDNDGb fzzKXH prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Список всех временных таблиц</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">TableName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">ObjectId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">schema_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">SchemaId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">parent_object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">ParentObjectId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token keyword" style="color:rgb(86, 156, 214)">type</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">TableType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">create_date</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">Created</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">modify_date</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">Modified</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">is_published</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">IsPublished</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">	</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">is_schema_published</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">IsSchemaPublished</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">objects</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">is_ms_shipped</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span></div></pre></div></div><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-EFWon sc-fYlSAf jwHCAw dgFwid prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Все соединения СУБД</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">DECLARE</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@AllConnections</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    SPID </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">Status</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    LOGIN </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    HostName </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    BlkBy </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    DBName </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    Command </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    CPUTime </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    DiskIO </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    LastBatch </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    ProgramName </span><span class="token keyword" style="color:rgb(86, 156, 214)">VARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    SPID_1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    REQUESTID </span><span class="token keyword" style="color:rgb(86, 156, 214)">INT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@AllConnections</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">EXEC</span><span class="token plain"> sp_who2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">@AllConnections</span></div></pre></div></div><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-dxjrPO sc-UFult erAHZK kVDLrw prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Информация о хранении временных таблиц</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">first_page</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">data_pages</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token keyword" style="color:rgb(86, 156, 214)">rows</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">tables</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> T</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partitions </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> P</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">object_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> tempdb</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">system_internals_allocation_units </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> AU</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;IN_ROW_DATA&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ROW_OVERFLOW_DATA&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">partition_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token operator" style="color:rgb(212, 212, 212)">OR</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">type_desc </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;LOB_DATA&#x27;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> AU</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">container_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> P</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">hobt_id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> T</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">name </span><span class="token operator" style="color:rgb(212, 212, 212)">LIKE</span><span class="token plain"> N</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;#ttTest%&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">-- Здесь отбор по имени временной таблицы</span></div></pre></div></div><div class="bg-blue-500 md:p-1 p-2 my-5"><div class="shadow-lg"><pre class="sc-jIYCZY sc-bbxCgr jxqnqb gHfHHM prism-code language-sql" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">-- Использующие tempdb-сессии</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    st</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dbid </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> QueryExecutionContextDBID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    DB_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">st</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dbid</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> QueryExecContextDBNAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    st</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">objectid </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> ModuleObjectId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    SUBSTRING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">st</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">TEXT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">statement_start_offset</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">CASE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">WHEN</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">statement_end_offset </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">THEN</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">LEN</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">CONVERT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NVARCHAR</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">MAX</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">st</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">TEXT</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">ELSE</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">statement_end_offset</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">END</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">statement_start_offset</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> Query_Text</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session_id </span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">request_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">exec_context_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_objects_alloc_page_count </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_objects_dealloc_page_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> OutStanding_user_objects_page_counts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">internal_objects_alloc_page_count </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">internal_objects_dealloc_page_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> OutStanding_internal_objects_page_counts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">start_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">command</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">open_transaction_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">percent_complete</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">estimated_completion_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">cpu_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">total_elapsed_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token keyword" style="color:rgb(86, 156, 214)">reads</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">writes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">logical_reads</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">granted_query_memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_es</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">HOST_NAME</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_es</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">login_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    dmv_es</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">program_name</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dm_db_task_space_usage dmv_tsu</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dm_exec_requests dmv_er</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session_id </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">request_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">request_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">INNER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">JOIN</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dm_exec_sessions dmv_es</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ON</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session_id </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> dmv_es</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session_id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">CROSS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">APPLY</span><span class="token plain"> sys</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">dm_exec_sql_text</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_er</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">sql_handle</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> st</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">internal_objects_alloc_page_count </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_objects_alloc_page_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_objects_alloc_page_count </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">user_objects_dealloc_page_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">internal_objects_alloc_page_count </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain"> dmv_tsu</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">internal_objects_dealloc_page_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DESC</span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Список не большой, но может пригодиться.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Будьте здоровы!</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Временные таблицы - очень интересный объект и то как с ним работает платформа 1С. Конечно, мы не раскрыли тему полностью, но, надеюсь, что-нибудь интересное Вы нашли.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Спасибо за внимание и будьте здоровы!</p></article><div class="Seperator_section_seperator_line__gdWIB dark:border-white border-black"></div><div class="PageLayout_author_and_more__wxN3W mx-auto"><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><div class="flex items-center"><div class="flex items-center justify-center shadow-xl rounded-full overflow-hidden bg-blue-500 shrink-0 w-[60px] h-[60px] mr-3 text-xl"><p class="text-center font-medium text-white">Y</p></div><div class="font-semibold"><p class="text-[20px]  mb-0 mt-0">YPermitin</p><p class="text-xs mt-0 mb-0">.NET, TSQL, DevOps, 1C:Enterprise</p></div></div><p class="text-[16px] mt-2">Developer, just developer.</p><div class="flex items-center flex-wrap mt-3"><a href="https://github.com/YPermitin" target="_blank" class="mr-[15px] text-[32px]" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a></div></div><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><p class="border-b border-gray-300 pb-2 mb-3 font-medium w-full">Поделиться</p><div class="flex flex-wrap items-center"><a class="mr-3" aria-label="facebook-share" href="https://www.facebook.com/sharer/sharer.php?u=https://ypermitin.github.io" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-92.4 233.5h-63.9c-50.1 0-59.8 23.8-59.8 58.8v77.1h119.6l-15.6 120.7h-104V912H539.2V602.2H434.9V481.4h104.3v-89c0-103.3 63.1-159.6 155.3-159.6 44.2 0 82.1 3.3 93.2 4.8v107.9z"></path></svg></a><a class="mr-3" aria-label="twitter-share" href="http://twitter.com/share?text=Check out this article!! &amp;url=https://ypermitin.github.io&amp;hashtags=webdevelopment,javacript,javascriptdaily,webdevelopmenttutorial,tutorial" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm215.3 337.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 0 1-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 0 1-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 0 0 229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"></path></svg></a><a class="mr-3" aria-label="linkedin-share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ypermitin.github.io&amp;title=Check out this article!!&amp;source=LinkedIn" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[23px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><button class="mr-3" name="copy-link" aria-label="copy-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></button></div><div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded fixed flex transition-all right-[10px] -bottom-20 opacity-0" role="alert"><strong class="font-bold">Link Copied</strong><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div></div><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><p class="border-b border-gray-300 pb-2 mb-3 font-medium w-full">Другие статьи</p><div class="flex flex-wrap"><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/.NET/2024-06/detect-devices-with-charp/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/.NET/2024-06/detect-devices-with-charp/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Поиск устройств в сети с .NET (C#)"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Поиск устройств в сети с .NET (C#)</div></div></div><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/.NET/2024-05/game-trainer-on-csharp-or-cpp/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/.NET/2024-05/game-trainer-on-csharp-or-cpp/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Управляем игровым миром с помощью C++ / C#"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Управляем игровым миром с помощью C++ / C#</div></div></div><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/.NET/2024-03/deploy-asp-net-core-on-linux/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/.NET/2024-03/deploy-asp-net-core-on-linux/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Развертывание ASP.NET Core приложений на Ubuntu Linux"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Развертывание ASP.NET Core приложений на Ubuntu Linux</div></div></div><a class="cursor-pointer hover:text-blue-500 block text-sm py-3 px-2 text-center dark:bg-slate-900 bg-blue-500 rounded text-white font-bold hover:!text-blue-900 dark:hover:!text-slate-400 transition-all" href="/blog/?author=YPermitin"><p>Все статьи от автора: <!-- -->YPermitin</p></a></div></div></div></div></section><div class="dark:bg-slate-900 dark:text-white bg-slate-100 text-black"><div class="md:container flex items-center md:justify-center justify-around flex-wrap md:text-[14px] text-[12px] py-5"><p class="my-0 mr-[10px] md:mr-3">Copyright © <!-- -->2024<!-- --> <!-- -->Убежище инженера</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{}},"page":"/blog/SQLServer/2020-04/fun-temporary-tables","query":{},"buildId":"w6SFBBOZSxxQOc3fUMUQB","nextExport":true,"autoExport":true,"isFallback":false,"dynamicIds":[7167,1465,9179,6806,1974],"scriptLoader":[]}</script></body></html>