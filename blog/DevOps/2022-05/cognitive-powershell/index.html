<!DOCTYPE html><html lang="en" translate="no"><head><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"/><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="google" content="notranslate"/><title>Познавательный PowerShell | Убежище инженера | YPermitin</title><meta name="robots" content="index,follow"/><meta name="description" content="Еще немного PowerShell нам в помощь."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://ypermitin.github.io/blog/DevOps/2022-05/cognitive-powershell"/><meta property="og:title" content="Познавательный PowerShell | Убежище инженера | YPermitin"/><meta property="og:description" content="Еще немного PowerShell нам в помощь."/><meta property="og:url" content="https://ypermitin.github.io/blog/DevOps/2022-05/cognitive-powershell"/><meta property="og:type" content="website"/><meta property="og:image" content="https://ypermitin.github.io/imp_assets/DevOps/2022-05/cognitive-powershell/logo.png"/><meta property="og:image:alt" content="Познавательный PowerShell | Убежище инженера | YPermitin"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:locale" content="en_IN"/><meta property="og:site_name" content="Убежище инженера"/><link rel="canonical" href="https://webexpe.com/"/><meta property="keywords" content="DevOps, PowerShell, 1С:Предприятие"/><meta property="al:web:url" content="https://ypermitin.github.io/blog/DevOps/2022-05/cognitive-powershell"/><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/18b64522130abd92.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/18b64522130abd92.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/74d45923820614f0.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/74d45923820614f0.css" crossorigin=""/><link rel="preload" href="/_next/static/css/4a9df9e795bce52b.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/4a9df9e795bce52b.css" crossorigin=""/><link rel="preload" href="/_next/static/css/88381d5dde4793c2.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/88381d5dde4793c2.css" crossorigin=""/><link rel="preload" href="/_next/static/css/ee5420a43edabb61.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/ee5420a43edabb61.css" crossorigin=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/_next/static/chunks/fea29d9f.ed258e6733dee3dc.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/3a17f596.ba96fa4a4d0542ad.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1664-4a06aa529298108a.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/7167.f2f73d92f46b437d.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1465.2204281cc9cfb98d.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/9179.149e20aab74a9c64.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/1974.532a76ac54dd3d02.js" crossorigin=""></script><script defer="" src="/_next/static/chunks/6806.0e24ace3ea941b14.js" crossorigin=""></script><script src="/_next/static/chunks/webpack-f8295fdb956353c0.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-92a422f151f77ddb.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-603010d06ef22166.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-5a7a978bdd9ff30c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/1102-e16f2e3f75ecbbbc.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/blog/DevOps/2022-05/cognitive-powershell-f1f0e3effe9dd3f8.js" defer="" crossorigin=""></script><script src="/_next/static/-__RSW8ubXuECQUx7ZerK/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/-__RSW8ubXuECQUx7ZerK/_ssgManifest.js" defer="" crossorigin=""></script></head><body class="bg-slate-100 dark:bg-slate-900 transition-all"><div id="__next"><div data-overlay-container="true"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><nav class="Navbar_navbar__W_ouQ bg-white  dark:bg-slate-900 dark:text-white text-black"><div class="container flex items-center justify-between px-2"><div class="flex items-center"><div class="Navbar_mobileBurgerToggle__Bj_52 mr-5  "><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="dark:text-white text-black text-2xl" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></div><a class="text-[22px] font-semibold" href="/">Убежище инженера</a></div><div class="flex items-center"><div class="text-[14px] font-normal items-center lg:flex hidden"><a class="cursor-pointer hover:text-blue-500 mx-2" href="/">Главная</a><div class="relative"><div class="flex items-center cursor-pointer mx-2"><p class="my-0">Блог</p><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-[20px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16.293 9.293 12 13.586 7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z"></path></svg></div><div class="overflow-auto absolute w-[180px] z-20 top-[30px] rounded-[4px] shadow-lg bg-white dark:bg-slate-800 border border-gray-300 dark:border-0 h-0 border-0"><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2" href="/blog/"><span>Все публикации</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=.NET"><span style="text-transform:capitalize">.NET</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=PostgreSQL"><span style="text-transform:capitalize">PostgreSQL</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=DevOps"><span style="text-transform:capitalize">DevOps</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=SQL%20Server"><span style="text-transform:capitalize">SQL Server</span></a></div></div><a class="cursor-pointer hover:text-blue-500 mx-2" href="/instruments/">Инструменты</a><a class="cursor-pointer hover:text-blue-500 mx-2" href="/about/">Обо мне</a><a class="cursor-pointer hover:text-blue-500 mx-2" href="/contact/">Контакты</a><div class="ml-5 pt-1"><a href="https://github.com/YPermitin/" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><a href="https://t.me/TinyDevVault" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg></a><a href="mailto:i.need.ypermitin@yandex.ru" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a><a href="https://boosty.to/ypermitin" target="_blank" rel="noopener noreferrer" class="text-[18px] inline-block mr-4"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 21h9.62a3.995 3.995 0 0 0 3.037-1.397l5.102-5.952a1 1 0 0 0-.442-1.6l-1.968-.656a3.043 3.043 0 0 0-2.823.503l-3.185 2.547-.617-1.235A3.98 3.98 0 0 0 9.146 11H4c-1.103 0-2 .897-2 2v6c0 1.103.897 2 2 2zm0-8h5.146c.763 0 1.448.423 1.789 1.105l.447.895H7v2h6.014a.996.996 0 0 0 .442-.11l.003-.001.004-.002h.003l.002-.001h.004l.001-.001c.009.003.003-.001.003-.001.01 0 .002-.001.002-.001h.001l.002-.001.003-.001.002-.001.002-.001.003-.001.002-.001c.003 0 .001-.001.002-.001l.003-.002.002-.001.002-.001.003-.001.002-.001h.001l.002-.001h.001l.002-.001.002-.001c.009-.001.003-.001.003-.001l.002-.001a.915.915 0 0 0 .11-.078l4.146-3.317c.262-.208.623-.273.94-.167l.557.186-4.133 4.823a2.029 2.029 0 0 1-1.52.688H4v-6zM16 2h-.017c-.163.002-1.006.039-1.983.705-.951-.648-1.774-.7-1.968-.704L12.002 2h-.004c-.801 0-1.555.313-2.119.878C9.313 3.445 9 4.198 9 5s.313 1.555.861 2.104l3.414 3.586a1.006 1.006 0 0 0 1.45-.001l3.396-3.568C18.688 6.555 19 5.802 19 5s-.313-1.555-.878-2.121A2.978 2.978 0 0 0 16.002 2H16zm1 3c0 .267-.104.518-.311.725L14 8.55l-2.707-2.843C11.104 5.518 11 5.267 11 5s.104-.518.294-.708A.977.977 0 0 1 11.979 4c.025.001.502.032 1.067.485.081.065.163.139.247.222l.707.707.707-.707c.084-.083.166-.157.247-.222.529-.425.976-.478 1.052-.484a.987.987 0 0 1 .701.292c.189.189.293.44.293.707z"></path></svg></a></div></div><div class="Navbar_search_icon_wrapper__1a_rL ml-5 dark:text-white"><button name="search-button" aria-label="search button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="dark:text-white text-black text-[22px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z"></path></svg></button></div><div class=""><button name="share" aria-label="share page"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="dark:text-white text-black text-[16px] mt-[7px] ml-2 mr-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z"></path></svg></button></div><button name="theme-switch" aria-label="theme button" class="Navbar_theme_switch__q7F_Z pl-3 dark:text-white text-black"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-md " height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path></svg></button></div></div></nav><aside class="Navbar_nav_sidebar_wrapper__M0KaI dark:bg-slate-900 dark:text-white bg-white text-black"><div class="flex items-center justify-between pb-3"><p class="">МЕНЮ</p><div><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-slate-800 dark:text-white text-[25px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg></div></div><hr/><div class="my-15"><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/">Главная</a><div class="relative"><div class="flex items-center cursor-pointer justify-between"><p class="my-0">Блог</p><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="text-[20px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16.293 9.293 12 13.586 7.707 9.293l-1.414 1.414L12 16.414l5.707-5.707z"></path></svg></div><div class="overflow-auto relative h-0 border-0"><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2" href="/blog/"><span>Все публикации</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=.NET"><span style="text-transform:capitalize">.NET</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=PostgreSQL"><span style="text-transform:capitalize">PostgreSQL</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=DevOps"><span style="text-transform:capitalize">DevOps</span></a><a class="cursor-pointer hover:text-blue-500 block text-sm py-2 px-2 border-t border-gray-400" href="/blog/?category=SQL%20Server"><span style="text-transform:capitalize">SQL Server</span></a></div></div><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/instruments/">Инструменты</a><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/about/">Обо мне</a><a class="cursor-pointer hover:text-blue-500 text-[16px] block my-3" href="/contact/">Контакты</a></div><hr/><div class="my-5"><p class="font-light">Подписаться : </p> <a href="https://github.com/YPermitin/" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><a href="https://t.me/TinyDevVault" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9l-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"></path></svg></a><a href="mailto:i.need.ypermitin@yandex.ru" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0 0 68.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"></path></svg></a><a href="https://boosty.to/ypermitin" target="_blank" rel="noopener noreferrer" class="text-[28px] inline-block mr-5 mt-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4 21h9.62a3.995 3.995 0 0 0 3.037-1.397l5.102-5.952a1 1 0 0 0-.442-1.6l-1.968-.656a3.043 3.043 0 0 0-2.823.503l-3.185 2.547-.617-1.235A3.98 3.98 0 0 0 9.146 11H4c-1.103 0-2 .897-2 2v6c0 1.103.897 2 2 2zm0-8h5.146c.763 0 1.448.423 1.789 1.105l.447.895H7v2h6.014a.996.996 0 0 0 .442-.11l.003-.001.004-.002h.003l.002-.001h.004l.001-.001c.009.003.003-.001.003-.001.01 0 .002-.001.002-.001h.001l.002-.001.003-.001.002-.001.002-.001.003-.001.002-.001c.003 0 .001-.001.002-.001l.003-.002.002-.001.002-.001.003-.001.002-.001h.001l.002-.001h.001l.002-.001.002-.001c.009-.001.003-.001.003-.001l.002-.001a.915.915 0 0 0 .11-.078l4.146-3.317c.262-.208.623-.273.94-.167l.557.186-4.133 4.823a2.029 2.029 0 0 1-1.52.688H4v-6zM16 2h-.017c-.163.002-1.006.039-1.983.705-.951-.648-1.774-.7-1.968-.704L12.002 2h-.004c-.801 0-1.555.313-2.119.878C9.313 3.445 9 4.198 9 5s.313 1.555.861 2.104l3.414 3.586a1.006 1.006 0 0 0 1.45-.001l3.396-3.568C18.688 6.555 19 5.802 19 5s-.313-1.555-.878-2.121A2.978 2.978 0 0 0 16.002 2H16zm1 3c0 .267-.104.518-.311.725L14 8.55l-2.707-2.843C11.104 5.518 11 5.267 11 5s.104-.518.294-.708A.977.977 0 0 1 11.979 4c.025.001.502.032 1.067.485.081.065.163.139.247.222l.707.707.707-.707c.084-.083.166-.157.247-.222.529-.425.976-.478 1.052-.484a.987.987 0 0 1 .701.292c.189.189.293.44.293.707z"></path></svg></a><hr class="mt-5"/></div><div class="mt-5 mb-4"><p class="mb-2 font-light">Переключиться на <!-- -->светлую<!-- --> тему :</p><button name="theme-switch" aria-label="theme-switch" class="Navbar_theme_switch__q7F_Z dark:text-white text-black"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-lg" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path></svg></button></div><hr/><div class="my-5"><p class="text-sm font-light dark:text-gray-400 text-gray-500 mb-1">Copyright © 2024</p></div></aside><div class="transition-all fixed h-screen w-screen flex items-center justify-center left-0 z-20 top-0 pointer-events-none opacity-0"><div class="absolute top-0 left-0 w-screen h-screen bg-black opacity-50"></div><div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded lg:w-1/6 mx-3 w-full relative z-10 transition-all top-10"><div class="flex border-gray-300 pb-2 mb-3 border-b"><p class="  font-medium w-full">Share:</p><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div><div class="flex flex-wrap items-center"><a class="mr-3" aria-label="facebook-share" href="https://www.facebook.com/sharer/sharer.php?u=https://ypermitin.github.io" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-92.4 233.5h-63.9c-50.1 0-59.8 23.8-59.8 58.8v77.1h119.6l-15.6 120.7h-104V912H539.2V602.2H434.9V481.4h104.3v-89c0-103.3 63.1-159.6 155.3-159.6 44.2 0 82.1 3.3 93.2 4.8v107.9z"></path></svg></a><a class="mr-3" aria-label="twitter-share" href="http://twitter.com/share?text=Check out this article!! &amp;url=https://ypermitin.github.io&amp;hashtags=webdevelopment,javacript,javascriptdaily,webdevelopmenttutorial,tutorial" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm215.3 337.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 0 1-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 0 1-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 0 0 229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"></path></svg></a><a class="mr-3" aria-label="linkedin-share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ypermitin.github.io&amp;title=Check out this article!!&amp;source=LinkedIn" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[23px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><button class="mr-3" name="copy-link" aria-label="copy-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></button></div><div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded fixed flex transition-all right-[10px] -bottom-20 opacity-0" role="alert"><strong class="font-bold">Link Copied</strong><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div></div></div><section class="PageLayout_centered_article_wrapper__gS3Af dark:bg-slate-900 dark:text-white"><div class="container px-0 md:px-[15px] pt-[50px] pb-[50px]"><article class="PageLayout_article_content__4dnq3 pb-[30px] px-3 bg-white dark:bg-slate-800 dark:border-none dark:drop-shadow-lg dark:text-white pt-10 md:pt-0 mx-auto font-regular text-lg leading-relaxed"><div class="mb-[30px]"><h1 class="ArticleHeader_articleTitle__3L1Bi text-center text-2xl md:text-4xl font-medium mt-[20px] mb-[5px]">Познавательный PowerShell</h1><div class="mb-[10px] mt-[15px] text-[14px] font-medium ArticleHeader_centered_article_header_author___gRtE"><p class="my-0 mx-[30px] font-medium">YPermitin<span class="px-1 font-light">в</span><a href="/blog/?category=DevOps">DevOps</a></p><p class="my-0">2022-05-13</p></div><div class="md:mt-2 flex flex-wrap justify-center"><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->DevOps</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->PowerShell</p><p class="text-[12px] font-normal mr-2 mb-1 inline-block text-gray-500 dark:text-gray-400">#<!-- -->1С:Предприятие</p></div></div><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Мы снова здесь!</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В прошлогодней статье <b><u><a href="/blog/DevOps/2021-05/amusing-powershell" target="_blank" rel="noopener noreferrer">“Занимательный PowerShell”</a></u></b> мы уже говорили про применение мощного скриптового языка PowerShell для решения насущных задач.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Сегодня мы пробежимся по новым скриптам и задачам, которые с их помощью можно решить. От задач связанных с платформой 1С, так и до более отдаленных.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В этот раз мы не будем рассматривать настройку окружения, различных инструментов для разработки скриптов на PowerShell и связанные с этим темы. Все это Вы можете посмотреть в предыдущей статье.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Итак, ближе к делу!</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Удаляйте журналы вовремя</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Все мы знаем, что журналы регистрации платформа 1С хранит в каталоге кластера, а точнее в подкаталогах каждой информационной базы. Это не относится к файловым базам, но они нам не интересны.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">С учетом того, что остается только текстовый вариант журнала, ведь из-за известных проблем SQLite-формата сама фирма “1С” отказывается от него (но это не точно?), встает задача периодической очистки файлов для освобождения места.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Чтобы делать очистку от старых записей журнала регистрации без остановки службы сервера 1С можно включить разделение файлов журнала по периоду. Например, по дням. Делается это в конфигураторе.</p><div class="Images_article_image__wrapper__QSTzx my-4 Images_size_medium__0iTcB display-block mx-auto my-5"><div aria-owns="rmiz-modal-" data-rmiz=""><div data-rmiz-content="not-found" style="visibility:visible"><img src="/imp_assets/DevOps/2022-05/cognitive-powershell/1. Разделение журнала регистрации.png" alt="Разделение журнала регистрации" width="100%" class="block"/></div></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Тогда на каждый день мы будем получать новые файлы. В большинстве случаев старые файлы не будут заняты серверными процессами платформы 1С и могут быть спокойно удалены.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Затем берем скрипт очистки от файлов журнала регистрации.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В скрипте указываем количество дней, сколько должны файлы журнала регистрации храниться. Также можно указать ниже отбор по имени информационной базы.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Скрипт находит установленные службы 1С, для каждой из них анализирует каталог кластера и во всех каталогах с файлами журналов регистрации удаляет файлы формата “*.lgp”. Путь к каталогам журналов регистрации получаем через анализ файла конфигурации кластера.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$limit</span><span class="token plain"> = </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Get-Date</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AddDays</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">15</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Файлы старше 15 дней</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$services1C</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-WmiObject</span><span class="token plain"> win32_service </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> ?</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;*&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">Select</span><span class="token plain"> Name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> DisplayName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> State</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> PathName </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PathName  </span><span class="token operator" style="color:rgb(212, 212, 212)">-Like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;*ragent.exe*&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$services1C</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">%</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$serviceExecPath</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$services1C</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PathName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$hash</span><span class="token plain"> = </span><span class="token namespace">[ordered]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$serviceExecPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Split</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;-&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Trim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Contains</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; &quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$value</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">split </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;\s+&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> 2</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token variable" style="color:rgb(156, 220, 254)">$name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$value</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterPath</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">d </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterRegPort</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">regport</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterRegPath</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterPath</span><span class="token string" style="color:rgb(206, 145, 120)">\reg_</span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterRegPort</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterRegPath</span><span class="token string" style="color:rgb(206, 145, 120)">\1CV8Reg.lst&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFileExists</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">PathType Leaf</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFileExists</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token boolean">$false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterRegPath</span><span class="token string" style="color:rgb(206, 145, 120)">\1CV8Clst.lst&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFileExists</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">PathType Leaf</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFileExists</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token boolean">$true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Select-String</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;{[A-Za-z0-9]{8}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{4}-[A-Za-z0-9]{12},\&quot;[A-Za-z0-9-_]+\&quot;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">AllMatches </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Foreach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Matches</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$parsedString</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">split </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;,&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$ibGuid</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$parsedString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;{&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$ibName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$parsedString</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&quot;&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)"># Фильтр по имени базы. По умолчанию все базы</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$ibName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;*&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPath</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterRegPath</span><span class="token string" style="color:rgb(206, 145, 120)">\</span><span class="token string variable" style="color:rgb(156, 220, 254)">$ibGuid</span><span class="token string" style="color:rgb(206, 145, 120)">\1Cv8Log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPathExists</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">PathType Container</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPathExists</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token boolean">$true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Infobase for clearing event log: </span><span class="token string variable" style="color:rgb(156, 220, 254)">$ibName</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Event log path: </span><span class="token string variable" style="color:rgb(156, 220, 254)">$eventLogPath</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain">            </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesData</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ChildItem</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lgp </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Force </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSIsContainer </span><span class="token operator" style="color:rgb(212, 212, 212)">-and</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CreationTime </span><span class="token operator" style="color:rgb(212, 212, 212)">-lt</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$limit</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Log files to remove:&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesData</span><span class="token plain">                    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesData</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Force</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesIndexes</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ChildItem</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$eventLogPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lgx </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Force </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSIsContainer </span><span class="token operator" style="color:rgb(212, 212, 212)">-and</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CreationTime </span><span class="token operator" style="color:rgb(212, 212, 212)">-lt</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$limit</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Log indexes files to remove:&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesIndexes</span><span class="token plain">                    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$logFilesIndexes</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Remove-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Force</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Cluster config file not found: </span><span class="token string variable" style="color:rgb(156, 220, 254)">$clusterConfigFile</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Под специфичные случаи скрипт можно поменять. Например, явно указав каталоги для очистки или добавив архивирование старых “*.lgp” файлов. В последнем случае не забудьте также сохранить файл с ссылочными данными “1Cv8.lgf”.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В общем, не стесняйтесь изменять скрипт под себя!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Для регулярного запуска можно использовать планировщик Windows, создав в нем задачу с подобной командой:</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">powershell.exe </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-NoProfile</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-ExecutionPolicy</span><span class="token plain"> Bypass </span><span class="token parameter variable" style="color:rgb(156, 220, 254)">-File</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;ПутьКФайлуСоСкриптом&gt;.ps1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Задача решена, теперь поехали дальше.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Ох уж эти COM-объекты</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В прошлой статье мы уже рассматривали действия по регистрации, удалению регистрации и проверке работы COM-компоненты платформы 1С. Теперь перейдем на другой уровень!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Всем известно, что на одном сервере могут быть зарегистрированы COM-компоненты разных версий платформы 1С. Но почему бы не автоматизировать этот процесс и выполнять регистрацию COM-компонентов по одному щелчку.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Принцип действия такой:</p><ul class="List_list__zLjGi list-disc pl-[30px]"><li>Указываем список COM-компонентов для регистрации с именем (должно быть уникальным); путем до comcntr.dll нужной версии; а также именем и пользователем операционной системы, от имени которого будет работать компонента.</li><li>Затем для каждой настройки устанавливается COM+-приложение.</li><li>Далее регистрируется компонента в приложении.</li><li>Обновляются настройки доступа.</li><li>И на последнем шаге корректируются настройки реестра, т.к. установка каждой новой COM-компоненты ломает настройки ранее установленных COM’ов.</li></ul><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">При этом, если ранее приложение и компонента уже были установлены, то предварительно они будут удалены.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Предварительно перечислеяем COM-компоненты для регистрации с их путями до DLL, а также параметры авторизации для каждого приложения (пользователя и пароль)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># По указанному имени после регистрации можно будет обращаться к этому COM-компоненту из скриптов или самой платформы 1С.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Поле CLSID не нужно заполнять (!!!). Оно будет заполнено автоматически присвоенным ID при регистрации компоненты.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$dllForRegistration</span><span class="token plain"> =</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token namespace">[pscustomobject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Name=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;V8.2.19.130.COMConnector&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">DLLPath=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;C:\Program Files\1cv82\8.2.19.130\bin\comcntr.dll&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserName=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;yy\ypermitin&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserPassword=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">CLSID=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token namespace">[pscustomobject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Name=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;V8.3.6.2530.COMConnector&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">DLLPath=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;C:\Program Files\1cv8\8.3.6.2530\bin\comcntr.dll&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserName=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;yy\ypermitin&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserPassword=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">CLSID=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token namespace">[pscustomobject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Name=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;V8.3.8.2442.COMConnector&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">DLLPath=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;C:\Program Files\1cv8\8.3.8.2442\bin\comcntr.dll&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserName=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;yy\ypermitin&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">UserPassword=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">CLSID=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> InstallApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$comObjectName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$DLLPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$userpassword</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;{</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function" style="color:rgb(220, 220, 170)">New-Guid</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">}&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">ToUpper</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comObjectName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;_&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppDesc</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Application for COM-component &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFound</span><span class="token plain"> = </span><span class="token boolean">$false</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> = </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> 1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFound</span><span class="token plain"> = </span><span class="token boolean">$true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">     </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">break</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">       </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-ne</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Remove</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token string" style="color:rgb(206, 145, 120)"> removed&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Red</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFound</span><span class="token plain"> = </span><span class="token boolean">$false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFound</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ID&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Description&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppDesc</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ApplicationAccessChecksEnabled&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token boolean">$True</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;AccessChecksLevel&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = 1 </span><span class="token comment" style="color:rgb(106, 153, 85)">#Component level</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Activation&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Local&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token namespace">[string]</span><span class="token plain">::IsNullOrEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-and</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token namespace">[string]</span><span class="token plain">::IsNullOrEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$userpassword</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Identity&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Password&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$userpassword</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># | Out-Null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token string" style="color:rgb(206, 145, 120)"> successfully registered&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Green</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">Else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token string" style="color:rgb(206, 145, 120)"> already exists, skipping&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Green</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token plain"> = </span><span class="token namespace">[pscustomobject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AppId=</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AppName=</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        AppDesc=</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppDesc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        NewApp=</span><span class="token variable" style="color:rgb(156, 220, 254)">$NewApp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        DLLPath = </span><span class="token variable" style="color:rgb(156, 220, 254)">$DLLPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        COMObjectName = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comObjectName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> InstallComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppDLL</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">DLLPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AppId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">   </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">InstallComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppDLL</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Components&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ForEach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AliasComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">COMObjectName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">break</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Components&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$CompIndex</span><span class="token plain"> = </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$newCreatedComponent</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ForEach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$CompIndex</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CompIndex</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> 1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(212, 212, 212)">-ne</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">COMObjectName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Remove</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$CompIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$newCreatedComponent</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token plain"> = </span><span class="token namespace">[pscustomobject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$newCreatedComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        Name = </span><span class="token variable" style="color:rgb(156, 220, 254)">$newCreatedComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> ConfigureSecurity</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AppId</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">   </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CLSID</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Добавляем права доступа на приложение и компоненты.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">#https://msdn.microsoft.com/en-us/library/windows/desktop/ms678849%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Roles&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$found</span><span class="token plain"> = </span><span class="token boolean">$false</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$Role</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Role</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CreatorOwner&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$found</span><span class="token plain"> = </span><span class="token boolean">$true</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$found</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Role</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Role</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CreatorOwner&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token namespace">[string]</span><span class="token plain">::IsNullOrEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Users</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Roles</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;UsersInRole&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CreatorOwner&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$User</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$User</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;User&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$username</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Users</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Components&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">ForEach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token plain"> In </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">If</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$Comp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">              </span><span class="token variable" style="color:rgb(156, 220, 254)">$ComponentFound</span><span class="token plain"> = </span><span class="token boolean">$True</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">If</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$ComponentFound</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$RolesForComponent</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$Comps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;RolesForComponent&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$RoleForComponent</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$RolesForComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$RoleForComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Name&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CreatorOwner&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$RolesForComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">Else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Warning</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;CLSID </span><span class="token string variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token string" style="color:rgb(206, 145, 120)"> not found&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">comobject COMAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">COMAdminCatalog</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Выполнение регистрации всех компонентов</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$dllForRegistration</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">   </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Создаем приложение COM+ для каждой версии COM-компоненты</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token plain"> = InstallApplication </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">DLLPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">UserName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">UserPassword</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Регистрируем COM-компонету в приложении и корректируем ее псевдоним</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token plain"> = InstallComponent </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CLSID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Обновить настройки доступа</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    ConfigureSecurity </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredApplication</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$registeredComponent</span><span class="token plain"> $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">UserName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Корректруем настройки реестра, &quot;сломанные&quot; после регистрации нескольких COM-компонентов 1C</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$dllForRegistration</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$destDLLPath</span><span class="token plain"> = $</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">DLLPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Registry::HKEY_CLASSES_ROOTCLSID</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">CLSID</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">InprocServer32&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ErrorAction SilentlyContinue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$destDLLPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-ne</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token function" style="color:rgb(220, 220, 170)">Set-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">InprocServer32&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Name </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Value </span><span class="token variable" style="color:rgb(156, 220, 254)">$destDLLPath</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Fixed DLL path for &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">Name</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; to &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$destDLLPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; from &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Green</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В результате мы получим установленные, зарегистрированные и готовые к использованию COM-компоненты платформы 1С. А если нужно будет добавить новую, то просто в скрипте дописываем настройку и запускаем еще разок!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В большинстве случаев перезагрузка сервера после этих манипуляций не нужна, но быть готовым к этому нужно.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Таким образом, одним кликом можно устанавливать множество COM-компонентов разных версий платформ 1С. И доустанавливать новые версии тоже. Не забывайте запускать скрипт с нужными привилегиями. Классная картина, не правда ли.</p><div class="Images_article_image__wrapper__QSTzx my-4 Images_size_medium__0iTcB display-block mx-auto my-5"><div aria-owns="rmiz-modal-" data-rmiz=""><div data-rmiz-content="not-found" style="visibility:visible"><img src="/imp_assets/DevOps/2022-05/cognitive-powershell/2. COM-компоненты нескольких версий.png" alt="COM-компоненты нескольких версий" width="100%" class="block"/></div></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Но зарегистрировать и установить - это одно дело. Иногда нужно еще и узнать какие COM-компоненты уже зарегистрированы в системе. И тут могут быть сложности, ведь регистрацию можно выполнить как с помощью утилиты “regsvr32.exe”, так и с помощь оснастки “Службы компонентов” (та, что на скрине выше). Так узнаем же!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Скрипт ниже получит список всех зарегистрированных COM-компонентов, покажет их CLSID, путь к DLL-файлу “comcntr.dll”, а также название инструмента, с помощью которого компонента была зарегистрирована (службы компонентов (comexp.msc) или утилита regsvr32.exe).</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Скрипт анализирует реестр на наличие установленных COM-компонентов.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token plain"> = </span><span class="token namespace">[System.Collections.ArrayList]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Поиск COM-компонентов, зарегистрированных с помощью regsvr32.exe</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">Get-ChildItem</span><span class="token plain"> HKLM:\Software\Classes </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ea 0 </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSChildName </span><span class="token operator" style="color:rgb(212, 212, 212)">-match</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;^\w+.\w+$&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-and</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\CLSID&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ea 0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSChildName    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSIDProperty</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\CLSID&quot;</span><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSIDProperty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;{&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;}&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Registry::HKEY_CLASSES_ROOT\CLSID\{</span><span class="token string variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token string" style="color:rgb(206, 145, 120)">}&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\InprocServer32&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ErrorAction SilentlyContinue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;*comcntr.dll&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token plain"> = </span><span class="token namespace">[PSCustomObject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            Name = </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            DLLPath = </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            RegisteredBy = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;regsvr32.exe&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Поиск COM-компонентов, зарегистрированных с помощью службы компонентов</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">com </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;COMAdmin.COMAdminCatalog.1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$application</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Components&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token variable" style="color:rgb(156, 220, 254)">$application</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;DLL&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;*comcntr.dll&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;{&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;}&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">#$component            </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token plain"> = </span><span class="token namespace">[PSCustomObject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                Name = </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                DLLPath = </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                RegisteredBy = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;comexp.msc&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Format-Table</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Это может быть полезно перед установкой новых COM-компонентов, чтобы знать текущую ситуацию на сервере.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Также бывают случаи, когда компоненту одновременно регистрируют как с помощью regsvr32.exe, так и с помощью службы компонентов (comexp.msc). Что может приводить к их некорректной работе. Возможно, Вы даже сталкивались с тем, что компоненту зарегистрировали, сервер перезапустили, но все равно она не работает. Возможно, это тот самый случай.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Вот такой результат мы можем получить.</p><div class="Images_article_image__wrapper__QSTzx my-4 Images_size_medium__0iTcB display-block mx-auto my-5"><div aria-owns="rmiz-modal-" data-rmiz=""><div data-rmiz-content="not-found" style="visibility:visible"><img src="/imp_assets/DevOps/2022-05/cognitive-powershell/3. Список зарегистрированных COM-компонентов.png" alt="Список зарегистрированных COM-компонентов" width="100%" class="block"/></div></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Но и это еще не все! Иногда можно столкнуться с непонятными ошибками при регистрации компонентов. В качестве кардинального решения можно удалить все зарегистрированные компоненты, перезагрузить сервер и начать заново. В этом нам поможет новый скрипт!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Весь код здесь уже должен быть знаком по предыдущим скриптам. В реестре ищем зарегистрированные компоненты, а потом удаляем их нужным способом.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token plain"> = </span><span class="token namespace">[System.Collections.ArrayList]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Поиск COM-компонентов, зарегистрированных с помощью regsvr32.exe</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">Get-ChildItem</span><span class="token plain"> HKLM:\Software\Classes </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ea 0 </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">Where-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSChildName </span><span class="token operator" style="color:rgb(212, 212, 212)">-match</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;^\w+\.\w+$&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-and</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\CLSID&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ea 0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">PSChildName    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSIDProperty</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\CLSID&quot;</span><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSIDProperty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;{&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;}&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Registry::HKEY_CLASSES_ROOT\CLSID\{</span><span class="token string variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token string" style="color:rgb(206, 145, 120)">}&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-Item</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$itemCLSIDKey</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Get-ItemProperty</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$ItemCLSID</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">PSPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">\InprocServer32&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ErrorAction SilentlyContinue</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$procInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;(default)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;*comcntr.dll&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token plain"> = </span><span class="token namespace">[PSCustomObject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            Name = </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            DLLPath = </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllPath</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                            RegisteredBy = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;regsvr32.exe&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                        </span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Поиск COM-компонентов, зарегистрированных с помощью службы компонентов</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">com </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;COMAdmin.COMAdminCatalog.1&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$application</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$applications</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Components&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token variable" style="color:rgb(156, 220, 254)">$application</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$components</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;DLL&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-like</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;*comcntr.dll&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$component</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Key </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;{&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;}&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token plain">         </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token plain"> = </span><span class="token namespace">[PSCustomObject]</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                Name = </span><span class="token variable" style="color:rgb(156, 220, 254)">$COMName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                CLSID = </span><span class="token variable" style="color:rgb(156, 220, 254)">$CLSID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                DLLPath = </span><span class="token variable" style="color:rgb(156, 220, 254)">$dllName</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                RegisteredBy = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;comexp.msc&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$COMObjectInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$allComObjects</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">RegisteredBy </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;regsvr32.exe&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$unregCommand</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;regsvr32.exe /u &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">DLLPath</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        cmd </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain">c </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$unregCommand</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Регистрация компоненты &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">Name</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; успешно отменена!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Red</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">elseif</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">RegisteredBy </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;comexp.msc&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">comobject COMAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">COMAdminCatalog</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$comAdmin</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetCollection</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Applications&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Populate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(212, 212, 212)">-replace</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;.&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;_&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> = </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">foreach</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token plain"> in </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">+</span><span class="token plain"> 1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Name </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$App</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">     </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token keyword" style="color:rgb(86, 156, 214)">break</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">       </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-ne</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundedObject</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Remove</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$AppFoundIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$Apps</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">SaveChanges</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$AppName</span><span class="token string" style="color:rgb(206, 145, 120)"> removed&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Red</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Регистрация компоненты &quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">Name</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string" style="color:rgb(206, 145, 120)">&quot; успешно отменена!&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ForegroundColor Red</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Проще простого!</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Теперь Вы можете массово регистрировать и удалять COM-компоненты платформы 1С разных версий, а также просто получать список всех зарегистрированных компонентов на сервере.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Немного Outlook</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Что мы все об 1С?! Давайте посмотрим на другие задачи. Например, работу с Microsoft Outlook. Этот замечательный почтовый клиент из пакета MS Office есть во многих компаниях. И частенько можно получить задачу по загрузке контактов и групп контактов в почтовый клиент из файлов или других источников.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Ниже пример скрипта как загружать контакты и группы.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В примере скрипта можно найти пример создания контактов и групп контактов с заполнением основных полей.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Исходные данные контактов, которые могут быть получены любым доступным способом (API, загрузка из файла и т.д.)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsByGroup</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$department</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Тюмень&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactListForGroup</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> System</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Collections</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Generic</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">List</span><span class="token namespace">[System.Object]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsByGroup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$department</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactListForGroup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsByGroup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token variable" style="color:rgb(156, 220, 254)">$department</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    innerPhone = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;+79220000000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    fullName   = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Джон Генри&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    email      = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;john123@corp.ru&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Инициализация объекта приложения</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$outlook</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">new-object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">com Outlook</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Application </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ea 1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Текущая сессия рабоыт с приложением</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$outlookSession</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$outlook</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">session</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Каталог контактов по умолчанию</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$outlookSession</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">GetDefaultFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsByGroup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Keys </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Выполняем поиск группы контактов. Если не смогли найти, то создаем.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># В этом случае группа контактов - это список рассылки. Также можно создавать группу контактов,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># вложенную непосредственно в группу. Тут кому как удобно.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$null</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">try</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Items</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Delete</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">catch</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Действий не требуется</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$dl</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Items</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;IPM.DistLIst&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$dl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">DLName = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$dl</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Items</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">&lt;#</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    # Это пример создания вложенной группы.</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    $subfolerItem = $null</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    try</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    {</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">        $subfolerItem = $contactsFolder.Folders.Item($contactGroupName);</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">        $subfolerItem.Delete();</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    } catch</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    {</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">        # Действий не требуется</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    }</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    $dl = $contactsFolder.Folders.Add(&quot;IPM.DistLIst&quot;);</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    $dl.DLName = $contactGroupName;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    $dl.Save() | Out-Null;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    $subfolerItem = $contactsFolder.Folders.Item($contactGroupName);</span></div><div class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">    #&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)"># Обходим контакты в кажой группе и создаем их. При этом в группу контактов (группу рассылки)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token comment" style="color:rgb(106, 153, 85)">#  добавляем нужные данные контактов.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsByGroup</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Контакт </span><span class="token string function" style="color:rgb(220, 220, 170)">$</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string function variable" style="color:rgb(156, 220, 254)">$_</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token string function" style="color:rgb(220, 220, 170)">email</span><span class="token string function punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token string" style="color:rgb(206, 145, 120)"> (</span><span class="token string variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token string" style="color:rgb(206, 145, 120)">)...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$fullName</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">fullName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Trim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">  </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$email</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">email</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Trim</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain">     </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Если контакт уже существует, то удаляем его, чтобы создать заново.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Items</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            Where</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">MessageClass </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;IPM.Contact&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">            </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            Where</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Email1Address </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$email</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Delete</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot; УДАЛЕН!&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">      </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot; Начало создания контакта...&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactsFolder</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Items</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Add</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Title = </span><span class="token variable" style="color:rgb(156, 220, 254)">$fullName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Email1Address = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">email</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Email1DisplayName = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$fullName</span><span class="token string" style="color:rgb(206, 145, 120)"> (</span><span class="token string variable" style="color:rgb(156, 220, 254)">$email</span><span class="token string" style="color:rgb(206, 145, 120)">)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">BusinessTelephoneNumber = </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">innerPhone</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Department = </span><span class="token variable" style="color:rgb(156, 220, 254)">$contactGroupName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Companies = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Моя компания&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">FullName = </span><span class="token variable" style="color:rgb(156, 220, 254)">$fullName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Заполняем другие свойства контакта в зависимости от задачи.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$newcontact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot; Контакт СОЗДАН!&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Создаем объект получаетеля для группы рассылки.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Если создается группа контактов, то это действие не требуется.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Получатель определяется по EMAIL, который передается в конструктор.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$recipientByContact</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$outlookSession</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">CreateRecipient</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$email</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$recipientByContact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Resolve</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Сопоставляем адрес с уже сущестующим контактом</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># $recipientByContact.Resolved # Тут должно быть TRUE, чтобы контакт был добавлен в список рассылки</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$recipientByContact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">AddMember</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$recipientByContact</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$subfolerItem</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Save</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Out-Null</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Ничего сложного! <!-- -->:)</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Да, это намного проще, чем регистрировать COM-компоненты 1С разных версий <!-- -->:)<!-- -->.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Работаем с сервисами Yandex</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">У компании “Яндекс” множество полезных сервисов. С ними можно работать из bash, 1С и любых других языков и платформ, в том числе и из PowerShell.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В скрипте ниже пример обращения к сервису перевода из Яндекс.Облака.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Для понимания происходящего в скрипте ниже рекомендую также ознакомиться с <b><u><a href="https://yandex.ru/dev/webmaster/doc/dg/concepts/About.html" target="_blank" rel="noopener noreferrer">официальной документацией</a></u></b>, в которой можно найти ссылки на описание работы и с другими сервисами. Не только переводчиком. Тут можно прочитать <b><u><a href="/blog/DevOps/2022-04/yandex-disk-and-bash" target="_blank" rel="noopener noreferrer">про получение IAM-токенов</a></u></b>.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 1. Убедиться, что платежный аккаунт находится в статусе ACTIVE или TRIAL_ACTIVE (https://console.cloud.yandex.ru/billing?section=accounts)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 2. Получите OAuth-токен в сервисе Яндекс.OAuth. Для этого перейдите по ссылке, нажмите Разрешить и скопируйте полученный OAuth-токен.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$yandexPassportOauthToken</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;&lt;OAuthТокен&gt;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 3. Получаем IAM-токен (https://cloud.yandex.ru/docs/iam/operations/iam-token/create). </span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># В примере ниже это будет выполняться через API, а не CLI.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Время жизни IAM-токена — не больше 12 часов, но рекомендуется запрашивать его чаще, например каждый час.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$Body</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> yandexPassportOauthToken = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$yandexPassportOauthToken</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ConvertTo-Json</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Compress</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$iamToken</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Invoke-RestMethod</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Method </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;POST&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Uri </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;https://iam.api.cloud.yandex.net/iam/v1/tokens&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Body </span><span class="token variable" style="color:rgb(156, 220, 254)">$Body</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ContentType </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Application/json&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Select-Object</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ExpandProperty iamToken</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 4. Получаем идентификатор облака. В примере берем только первый элемент.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$cloudInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Invoke-RestMethod</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Method </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;GET&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Uri </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;https://resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Headers @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Authorization = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Bearer </span><span class="token string variable" style="color:rgb(156, 220, 254)">$iamToken</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Body </span><span class="token variable" style="color:rgb(156, 220, 254)">$Body</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ContentType </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Application/json&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$cloudId</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$cloudInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">clouds</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 5. Получаем идентификатор любого каталога, на который у аккаунта есть роль editor или выше.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Чтобы получить список каталогов с идентификаторами, воспользуйтесь методом list для ресурса Folder.</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$folderInfo</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Invoke-RestMethod</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Method </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;GET&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Uri </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;https://resource-manager.api.cloud.yandex.net/resource-manager/v1/folders?cloud_id=</span><span class="token string variable" style="color:rgb(156, 220, 254)">$cloudId</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Headers @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Authorization = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Bearer </span><span class="token string variable" style="color:rgb(156, 220, 254)">$iamToken</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Body </span><span class="token variable" style="color:rgb(156, 220, 254)">$Body</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ContentType </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Application/json&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$folderId</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$folderInfo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">folders</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">id</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Шаг 6. Переводим текст</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Пошаговая инструкция https://cloud.yandex.ru/docs/translate/operations/translate</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Официальная документация https://cloud.yandex.ru/docs/translate/?utm_source=console&amp;utm_medium=empty-page&amp;utm_campaign=translate</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$sourceLanguage</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ru&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Язык назначения</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$targetLanguage</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;en&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># Язык назначения</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$text</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Привет из космоса!&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Все будет хорошо!&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;1С великолепна!!!&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$postData</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    sourceLanguageCode = </span><span class="token variable" style="color:rgb(156, 220, 254)">$sourceLanguage</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    targetLanguageCode = </span><span class="token variable" style="color:rgb(156, 220, 254)">$targetLanguage</span><span class="token plain">    </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    texts = </span><span class="token variable" style="color:rgb(156, 220, 254)">$text</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    folderId = </span><span class="token variable" style="color:rgb(156, 220, 254)">$folderId</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    glossaryConfig = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        glossaryData = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            glossaryPairs = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    sourceText = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;1С великолепна&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                    translatedText = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;.NET is awesome&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$postDataAsJson</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$postData</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ConvertTo-Json</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Depth 5</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$operationResult</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Invoke-RestMethod</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Method </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;POST&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">ContentType </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;application/json; charset=UTF-8&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Uri </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;https://translate.api.cloud.yandex.net/translate/v2/translate&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Headers @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain">Authorization = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Bearer </span><span class="token string variable" style="color:rgb(156, 220, 254)">$iamToken</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Body </span><span class="token variable" style="color:rgb(156, 220, 254)">$postDataAsJson</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)"># -OutFile &quot;D:\Trash\result.log&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$operationResult</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Результаты перевода текста.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$operationResult</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">translations</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$operationResult</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">translations </span><span class="token punctuation" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ForEach-Object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$_</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">text</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В примере для разнообразия также используем глоссарий. В результате этот текст:</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-text" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">&quot;Привет из космоса!&quot;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">&quot;Все будет хорошо!&quot;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">&quot;1С великолепна!!!&quot;</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Будет переведен вот в этот:</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-text" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Результат перевода:</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Greetings From Outer Space!</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">Everything will be fine!</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">.NET is awesome!!!</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Профит! <!-- -->:)</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Используя этот пример можно обращаться и к другим сервисом Яндекса.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Заблокирован ли файл?</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Еще задачей может быть проверка заблокирован ли файл другим приложением.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">С помощью функции Test-FileLock можно проверить занят ли файл.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Test-FileLock</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">param</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token namespace">[parameter(Mandatory = $true)]</span><span class="token namespace">[string]</span><span class="token variable" style="color:rgb(156, 220, 254)">$Path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token namespace">[parameter(Mandatory = $false)]</span><span class="token namespace">[System.IO.FileAccess]</span><span class="token variable" style="color:rgb(156, 220, 254)">$AccessType</span><span class="token plain"> = </span><span class="token namespace">[System.IO.FileAccess]</span><span class="token plain">::Read</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token variable" style="color:rgb(156, 220, 254)">$oFile</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">New-Object</span><span class="token plain"> System</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">IO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">FileInfo </span><span class="token variable" style="color:rgb(156, 220, 254)">$Path</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">Test-Path</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">Path </span><span class="token variable" style="color:rgb(156, 220, 254)">$Path</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token boolean">$false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">$false</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># [System.IO.FileAccess]::Read - проверяется возможность доступа к файлу только на чтение</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Если нужно проверить доступ на запись, то параметр можно заменить на [System.IO.FileAccess]::ReadWrite</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token variable" style="color:rgb(156, 220, 254)">$oStream</span><span class="token plain"> = </span><span class="token variable" style="color:rgb(156, 220, 254)">$oFile</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token namespace">[System.IO.FileMode]</span><span class="token plain">::Open</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$AccessType</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token namespace">[System.IO.FileShare]</span><span class="token plain">::ReadWrite</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">  </span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$oStream</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token variable" style="color:rgb(156, 220, 254)">$oStream</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">Close</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">$false</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)"># Файл заблокирован процессом</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">$true</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$testFile</span><span class="token plain"> = </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;C:\swapfile.sys&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$fileLocked</span><span class="token plain"> = </span><span class="token function" style="color:rgb(220, 220, 170)">Test-FileLock</span><span class="token plain"> </span><span class="token variable" style="color:rgb(156, 220, 254)">$testFile</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token namespace">[System.IO.FileAccess]</span><span class="token plain">::ReadWrite</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token variable" style="color:rgb(156, 220, 254)">$fileLocked</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-eq</span><span class="token plain"> </span><span class="token boolean">$true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">Write-Host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;Файл заблокирован другим приложением.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Может быть полезно во многих случаях.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Надежное копирование файлов</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Для надежного копирования файлов по сети можно использовать утилиты <b><u><a href="https://learn.microsoft.com/ru-ru/windows-server/administration/windows-commands/robocopy" target="_blank" rel="noopener noreferrer">Robocopy</a></u></b>. Из PowerShell это выглядит так.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">В официальной документации можно найти описание всех параметров.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-powershell" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$source</span><span class="token plain">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;C:\source&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$dest</span><span class="token plain">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;D:\destination&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$what</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/COPYALL&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/B&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/SEC&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/MIR&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$options</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/R:0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/W:0&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/NFL&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;/NDL&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token variable" style="color:rgb(156, 220, 254)">$cmdArgs</span><span class="token plain"> = @</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$source</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string variable" style="color:rgb(156, 220, 254)">$dest</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token variable" style="color:rgb(156, 220, 254)">$what</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token variable" style="color:rgb(156, 220, 254)">$options</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">robocopy @cmdArgs</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Сценарии использования тоже очень разнообразные: от копирования бэкапов, то синхронизации каталогов между серверами.</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Сессии Windows</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">И под конец самый простой пример - получаем список сессий Windows и завершаем их по необходимости.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Простые шаги.</p><div class="bg-blue-500 md:p-5 p-2 my-5"><div class="shadow-lg"><pre class="sc-beySPh jEcCTP prism-code language-bash" style="color:#9CDCFE;background-color:#1E1E1E"><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Список сессий Windows</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">query user</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Завершение пользовательского сеанса Windows по ID</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">logoff </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">ID сессии</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#9CDCFE"><span class="token plain">                </span></div></pre></div></div><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Простое решение <!-- -->:)</p><h1 class="font-bold text-3xl md:text-4xl my-[10px] mt-10 md:text" style="text-align:unset">Хватит, пожалуй</h1><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">Порция примеров работы с PowerShell закончена. Но кейсов использования этого прекрасного инструмента бесконечное количество. Все самое интересное можно найти в официальной документации, GitHub и на других просторах интернета.</p><p class="font-regular mb-3 text-lg leading-relaxed" style="text-align:unset">PowerShell еще вернется! Удачи в делах и хорошего настроения!</p></article><div class="Seperator_section_seperator_line__gdWIB dark:border-white border-black"></div><div class="PageLayout_author_and_more__wxN3W mx-auto"><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><div class="flex items-center"><div class="flex items-center justify-center shadow-xl rounded-full overflow-hidden bg-blue-500 shrink-0 w-[60px] h-[60px] mr-3 text-xl"><p class="text-center font-medium text-white">Y</p></div><div class="font-semibold"><p class="text-[20px]  mb-0 mt-0">YPermitin</p><p class="text-xs mt-0 mb-0">.NET, TSQL, DevOps, 1C:Enterprise</p></div></div><p class="text-[16px] mt-2">Developer, just developer.</p><div class="flex items-center flex-wrap mt-3"><a href="https://github.com/YPermitin" target="_blank" class="mr-[15px] text-[32px]" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a></div></div><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><p class="border-b border-gray-300 pb-2 mb-3 font-medium w-full">Поделиться</p><div class="flex flex-wrap items-center"><a class="mr-3" aria-label="facebook-share" href="https://www.facebook.com/sharer/sharer.php?u=https://ypermitin.github.io" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-92.4 233.5h-63.9c-50.1 0-59.8 23.8-59.8 58.8v77.1h119.6l-15.6 120.7h-104V912H539.2V602.2H434.9V481.4h104.3v-89c0-103.3 63.1-159.6 155.3-159.6 44.2 0 82.1 3.3 93.2 4.8v107.9z"></path></svg></a><a class="mr-3" aria-label="twitter-share" href="http://twitter.com/share?text=Check out this article!! &amp;url=https://ypermitin.github.io&amp;hashtags=webdevelopment,javacript,javascriptdaily,webdevelopmenttutorial,tutorial" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm215.3 337.7c.3 4.7.3 9.6.3 14.4 0 146.8-111.8 315.9-316.1 315.9-63 0-121.4-18.3-170.6-49.8 9 1 17.6 1.4 26.8 1.4 52 0 99.8-17.6 137.9-47.4-48.8-1-89.8-33-103.8-77 17.1 2.5 32.5 2.5 50.1-2a111 111 0 0 1-88.9-109v-1.4c14.7 8.3 32 13.4 50.1 14.1a111.13 111.13 0 0 1-49.5-92.4c0-20.7 5.4-39.6 15.1-56a315.28 315.28 0 0 0 229 116.1C492 353.1 548.4 292 616.2 292c32 0 60.8 13.4 81.1 35 25.1-4.7 49.1-14.1 70.5-26.7-8.3 25.7-25.7 47.4-48.8 61.1 22.4-2.4 44-8.6 64-17.3-15.1 22.2-34 41.9-55.7 57.6z"></path></svg></a><a class="mr-3" aria-label="linkedin-share" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://ypermitin.github.io&amp;title=Check out this article!!&amp;source=LinkedIn" target="popup"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[23px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"></path></svg></a><button class="mr-3" name="copy-link" aria-label="copy-link"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="text-[30px]" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></button></div><div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded fixed flex transition-all right-[10px] -bottom-20 opacity-0" role="alert"><strong class="font-bold">Link Copied</strong><span class="pl-5"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="pt-1 text-[18px] cursor-pointer" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"></path></svg></span></div></div><div class="bg-white dark:bg-slate-800 dark:border-none border-slate-100 shadow-lg border md:rounded-[8px] px-[15px] py-[10px] mb-[30px] overflow-hidden"><p class="border-b border-gray-300 pb-2 mb-3 font-medium w-full">Другие статьи</p><div class="flex flex-wrap"><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/.NET/2024-05/game-trainer-on-csharp-or-cpp/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/.NET/2024-05/game-trainer-on-csharp-or-cpp/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Управляем игровым миром с помощью C++ / C#"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Управляем игровым миром с помощью C++ / C#</div></div></div><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/.NET/2024-03/deploy-asp-net-core-on-linux/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/.NET/2024-03/deploy-asp-net-core-on-linux/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Развертывание ASP.NET Core приложений на Ubuntu Linux"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Развертывание ASP.NET Core приложений на Ubuntu Linux</div></div></div><div class="mb-3 cursor-pointer lg:w-1/3 md:w-1/2 w-full md:pr-2" href="/blog/PostgerSQL/2022-12/simple-maintenance-postgesql/"><div class=" rounded-[3px] dark:bg-slate-800 border border-slate-200 dark:border-slate-900 flex items-center overflow-hidden shadow-lg hover:shadow-md "><div class="object-cover shrink-0"><img src="/imp_assets/PostgreSQL/2022-12/simple-maintenance-postgesql/logo.png" class="w-[120px] h-[70px] mr-2 object-cover" alt="Настройка обслуживания PostgreSQL. Основное и простое"/></div><div class="pr-1 text-[16px] hover:text-blue-500 font-semibold">Настройка обслуживания PostgreSQL. Основное и простое</div></div></div><a class="cursor-pointer hover:text-blue-500 block text-sm py-3 px-2 text-center dark:bg-slate-900 bg-blue-500 rounded text-white font-bold hover:!text-blue-900 dark:hover:!text-slate-400 transition-all" href="/blog/?author=YPermitin"><p>Все статьи от автора: <!-- -->YPermitin</p></a></div></div></div></div></section><div class="dark:bg-slate-900 dark:text-white bg-slate-100 text-black"><div class="md:container flex items-center md:justify-center justify-around flex-wrap md:text-[14px] text-[12px] py-5"><p class="my-0 mr-[10px] md:mr-3">Copyright © <!-- -->2024<!-- --> <!-- -->Убежище инженера</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{}},"page":"/blog/DevOps/2022-05/cognitive-powershell","query":{},"buildId":"-__RSW8ubXuECQUx7ZerK","nextExport":true,"autoExport":true,"isFallback":false,"dynamicIds":[7167,1465,9179,1974,6806],"scriptLoader":[]}</script></body></html>